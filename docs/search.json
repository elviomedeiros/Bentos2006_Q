[
  {
    "objectID": "index.html#study-area-and-sampling-design",
    "href": "index.html#study-area-and-sampling-design",
    "title": "Predictors of the macroinvertebrate fauna in semiarid aquatic systems",
    "section": "2.1 Study Area and Sampling Design",
    "text": "2.1 Study Area and Sampling Design\nThe present study was performed at the easter limits of the semiarid region of Brazil (Figure 1). This area is characterized by low average precipitation, concentrated in a few months of the year, usually between January and July (Figure 2), and high average annual temperatures between 20 and 32 °C (Barbosa et al. 2025). The main hydrological feature in the study area is the intermittence of surface water flow of its streams and rivers and, as a consequence, many man-made reservoirs built from the damming of the intermittent streams (Maltchik and Medeiros 2006). These rivers flow through the “Caatinga”, a deciduous arboreal to shrubby open forest (Silva et al. 2017). The climate in the study area is semiarid (BS´h hot and dry) and equatorial (As, dry summer) (Peel et al. 2007). A diverse array of sampling sites was chosen to represent the most common aquatic environment types of semiarid Brazil, with different sets of specificities and across different catchment basins. We sampled six sites, three of which consisted of stream reaches with surface water flow (during the rainy season) or isolated temporary pools (during the dry season) and three sites in artificial reservoirs created from stream impoundment. Sampling was conducted during the year of 2006 on four occasions during the rainy (April and June) and dry seasons (September and December)."
  },
  {
    "objectID": "index.html#data-collection",
    "href": "index.html#data-collection",
    "title": "Predictors of the macroinvertebrate fauna in semiarid aquatic systems",
    "section": "2.2 Data Collection",
    "text": "2.2 Data Collection\nEnvironmental characteristics of each site were measured in four sets of variables: (a) site morphology, (b) water quality, (c) sediment composition, and (d) marginal habitat structure. Site morphology was assessed by their width (cm) and depth (cm) measured from three random transects. Catchment scale variables (such as elevation and river length) were measured using handheld GPS and satellite imagery. Water quality was evaluated as physical and chemical variables that were measured using portable equipment for temperature (°C) and dissolved oxygen (mg/L). Transparency (cm) was measured using a Secchi disk and water velocity (m/s) was estimated using the float method (Maitland 1990). Sediment composition and the habitat physical structure followed protocols from Pusey Pusey et al. (2004) and Mugodo et al. (2006), adapted by Medeiros et al. (2008), where they are estimated from 9 to 12 one meter quadrants along the margins (terrestrial-aquatic interface) and determined by visual estimation of sediment type percentage cover (mud, sand, cobbles, small gravel, large gravel, rocks and bedrock) and of littoral and sub-aquatic structures (macrophytes, littoral grass, leaf litter, attached algae, filamentous algae, overhanging vegetation, submerged vegetation, small woody debris, large woody debris and root masses). At each study site, three samples of benthic macroinvertebrates were collected in the margins using a D type net (40 cm wide and 250 μm) to represent different habitat types. Samples were fixed in situ with 4% formalin and subsequently preserved in 70% ethanol. Macroinvertebrate specimens were sorted and identified to the lowest possible taxonomic level, usually family (McCafferty and Provonsha (1983), Mugnai et al. (2010), Thorp and Covich (2010) and Merritt et al. (2019), among others)."
  },
  {
    "objectID": "index.html#statistical-analyses",
    "href": "index.html#statistical-analyses",
    "title": "Predictors of the macroinvertebrate fauna in semiarid aquatic systems",
    "section": "2.3 Statistical Analyses",
    "text": "2.3 Statistical Analyses\nPrior to statistical analysis, environmental variables were checked for multivariate collinearity and square root transformed to enhance normality and homogeneity of variances (Sokal and Rohlf 1995).\n\n\nCode: Importing and organizing data\n#BENTOS2006 - ORGANIZANDO DADOS----\n#####....----\n\ndev.off() #apaga os graficos, se houver algum\nrm(list=ls(all=TRUE)) #limpa a memória\ncat(\"\\014\") #limpa o console\n#shell.exec(getwd())\ngetwd()\nsetwd(\"D:/Elvio/OneDrive/MSS/_Bentos-2006/Bentos2006_Q\")\nlibrary(openxlsx)\n\n##CARREGANDO MATRIZES BRUTAS----\n\ndensidade <- read.xlsx(\"D:/Elvio/OneDrive/MSS/_Bentos-2006/Bentos2006/zoobentos2006_com.xlsx\",\n                   rowNames = T,\n                   colNames = T,\n                   sheet = \"densidade\")\nhabitat <- read.xlsx(\"D:/Elvio/OneDrive/MSS/_Bentos-2006/Bentos2006/zoobentos2006_hab.xlsx\",\n                    rowNames = T,\n                    colNames = T,\n                    sheet = \"ambiente\")\ngrupos <- read.xlsx(\"D:/Elvio/OneDrive/MSS/_Bentos-2006/Bentos2006/zoobentos2006_hab.xlsx\",\n                   rowNames = T,\n                   colNames = T,\n                   sheet = \"grupos\")\ndensidade[1:5,1:5] #[1:5,1:5] mostra apenas as linhas e colunas de 1 a 5.\n\n###REMOVENDO LINHAS ZERADAS DE HABITAT----\nrownames(habitat)\ndel_rows <- c(\"B-A-MU-1\", \"B-R-EP-1\") #em Medeiros et al. 2024 BAMU1 foi mantido\ndel_rows\nm_hab <- habitat[!(row.names(habitat) %in% c(del_rows)),]\nm_hab\n\n###PARTICIONANDO TABELA DE GRUPOS----\nt_grps <- grupos[!(row.names(grupos) %in% del_rows),]\n\n##COLUNAS ZERADAS DE DENSIDADE----\nsum <- colSums(densidade)\nsum\nzero_sum <- names(which(colSums(densidade) == 0))\nzero_sum #nomes das espécies zeradas\nm_part_cols <- densidade[(colSums(densidade) != 0)] #em != a exclamação inverte o sentido\nzero_sum2 <- names(which(colSums(m_part_cols) == 0))\nzero_sum2 #nomes das espécies zeradas\nsum<-colSums(m_part_cols)\nsum\n\n###LINHAS ZERADAS DE DENSIDADE----\nm_part2 <- as.data.frame(t(m_part_cols))\nsum <- colSums(m_part2)\nsum\nzero_sum <- names(which(colSums(m_part2) == 0))\nzero_sum #nomes das espécies zeradas\nm_part_rows <- m_part2[(colSums(m_part2) != 0)] #em != a exclamação inverte o sentido\nzero_sum2 <- names(which(colSums(m_part_rows) == 0))\nzero_sum2 #nomes das espécies zeradas\nsum<-colSums(m_part_rows)\nsum\nm_dens <- as.data.frame((t(m_part_rows)))\n\n##SALVANDO MATRIZES FINAIS REMOVIDAS AS LINHAS/COLUNAS ZERADAS----\n\nwrite.table(m_dens, \"m_dens.csv\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\nwrite.table(t_grps, \"t_grps.csv\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\nwrite.table(m_hab, \"m_hab.csv\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\nt_grps <- read.csv(\"t_grps.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_dens <- read.csv(\"m_dens.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_hab <- read.csv(\"m_hab.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\n\n#BENTOS2006 - MATRIZ DE CONTAGEM----\n#####....----\n\nlibrary(openxlsx)\ncontagem <- read.xlsx(\"D:/Elvio/OneDrive/MSS/_Bentos-2006/Bentos2006/zoobentos2006_com.xlsx\",\n                       rowNames = T,\n                       colNames = T,\n                       sheet = \"contagem\")\ncontagem[1:5,1:5] #[1:5,1:5] mostra apenas as linhas e colunas de 1 a 5.\n\n###COLUNAS ZERADAS DE CONTAGEM----\nsum <- colSums(contagem)\nsum\nzero_sum <- names(which(colSums(contagem) == 0))\nzero_sum #nomes das espécies zeradas\nm_part_cols <- contagem[(colSums(contagem) != 0)] #em != a exclamação inverte o sentido\nzero_sum2 <- names(which(colSums(m_part_cols) == 0))\nzero_sum2 #nomes das espécies zeradas\nsum<-colSums(m_part_cols)\nsum\n\n###LINHAS ZERADAS DE CONTAGEM----\nm_part2 <- as.data.frame(t(m_part_cols))\nsum <- colSums(m_part2)\nsum\nzero_sum <- names(which(colSums(m_part2) == 0))\nzero_sum #nomes das espécies zeradas\nm_part_rows <- m_part2[(colSums(m_part2) != 0)] #em != a exclamação inverte o sentido\nzero_sum2 <- names(which(colSums(m_part_rows) == 0))\nzero_sum2 #nomes das espécies zeradas\nsum<-colSums(m_part_rows)\nsum\nm_cont <- (t(m_part_rows))\nm_cont\nsum(m_cont)\nncol(m_cont)\n\n##SALVANDO MATRIZ FINAL DE CONTAGEM----\n\nwrite.table(m_cont, \"m_cont.csv\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\nm_cont <- read.csv(\"m_cont.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_cont\n\n\n\n\nCode: Correlations of environment data correlations\n#BENTOS2006----\n####----\n\n##ORGANIZANDO DADOS----\n\ndev.off()\nrm(list=ls(all=TRUE))\ncat(\"\\014\")\nt_grps <- read.csv(\"t_grps.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_hab <- read.csv(\"m_hab.csv\",\n                  sep = \";\", dec = \".\",\n                  row.names = 1,\n                  header = TRUE,\n                  na.strings = NA)\n\n##CORRELOGRAMA E REMOÇÃO DE VARIÁVEIS REDUNDANTES OU DESNECESSÁRIAS----\n\nlibrary(psych)\ncolnames(m_hab)\n\npng(\"fig-hab_pairs.png\")\npairs.panels(m_hab[,1:27],\n             method = \"pearson\", # correlation method\n             scale = FALSE, lm = FALSE,\n             hist.col = \"#00AFBB\", pch = 19,\n             density = TRUE,  # show density plots\n             ellipses = TRUE, # show correlation ellipses\n             alpha = 0.5)\ndev.off()\n\ncor <- cor(m_hab)\ncor\n\nlibrary(corrplot)\npng(\"fig-hab_corrplot.png\")\ncorrplot(cor, method = \"circle\")\ndev.off()\n\n#### IMPRESSÃO EM PAPEL\n#win.print()\n#corrplot(cor, method = \"circle\")\n#dev.off()\n\n##DELETANDO COLINEARES----\n\nsink(file = \"colineares.txt\", append = F, split = T)\ncolnames(m_hab)\ndel_cols <- c() #\"g.river_length\",\"g.altitude\" #NÃO DELETEI VARIÁVEIS\nm_hab_part <- m_hab[, !(colnames(m_hab) %in% del_cols)]\n\n##SOMANDO REDUNDANTES----\n\nm_hab_part$s.gravel <- m_hab_part$s.smlgrav + m_hab_part$s.lrggrav + m_hab_part$s.cobbles\nm_hab_part <- m_hab_part[, !(colnames(m_hab_part)\n                             %in% c(\"s.smlgrav\", \"s.lrggrav\", \"s.cobbles\"))]\nm_hab_part$s.rock <- m_hab_part$s.rocks + m_hab_part$s.bedrock\nm_hab_part <- m_hab_part[, !(colnames(m_hab_part)\n                             %in% c(\"s.rocks\", \"s.bedrock\"))]\nm_hab_part$h.algae <- m_hab_part$h.filalgae + m_hab_part$h.attalgae\nm_hab_part <- m_hab_part[, !(colnames(m_hab_part)\n                             %in% c(\"h.filalgae\", \"h.attalgae\"))]\nm_hab_part$h.debris <- m_hab_part$h.smldeb + m_hab_part$h.lrgdeb\nm_hab_part <- m_hab_part[, !(colnames(m_hab_part)\n                             %in% c(\"h.smldeb\", \"h.lrgdeb\"))]\n\ncolnames(m_hab_part)\nm_hab_part\nsink()\n\nwrite.table(m_hab_part, \"m_hab_part.csv\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\nm_hab_part <- read.csv(\"m_hab_part.csv\",\n                  sep = \";\", dec = \".\",\n                  row.names = 1,\n                  header = TRUE,\n                  na.strings = NA)\n\n\nThese variables were then subject to a Principal Component Analysis (PCA) to have their multivariate correlations described across sites. The PCA was conducted on the square root transformed and scaled data using the R package FactoMineR (Lê et al. 2008).\nFor the macroinvertebrate community, all analyses were performed on density of individuals (ind/m2) calculated by the ratio between the number of individuals and the sampled area of the D-net in each sample. Macroinvertebrate fauna was described by means of average density and rarefied taxa richness, where richness was standardized by the average sample size across all samples. Life stages (larvae, pupae, nymph and adults) were treated as separate taxa, considering their ecological differences (Ross et al. 1987). Comparisons of density and richness among study sites were tested by one-way ANOVA followed by post hoc multiple comparisons using Tukey’s HSD test (α=0.05) (Zar 1999).\nA Stepwise Multiple Regression (SMR) analysis using the Akaike Information (MASS R package, stepAIC function, Venables and Ripley (2002)) as the selection criterion was performed in both directions (forward and backward) to identify the best predictors across subsets of variables (site morphology, water quality, sediment composition and marginal habitat structures) for species richness and density (Vendramin et al. 2020).\nVariation in species composition among sites were ordinated using Non-metric Multidimensional Scaling (NMDS) (Lanés et al. 2018). Data were arcsine square-root transformed after relativization and the Bray-Curtis distance was calculated. Significance of groups was tested using the Multi-Response Permutation Procedure (MRPP) (Biondini et al. (1985), McCune and Grace (2002)). For all MRPP analyses, the A value is presented as a measure of homogeneity degree in a cluster, as compared to random expectation.\nIndicator Species Analysis (ISA) was performed to evaluate species–site associations (indicspecies R package, De Cáceres and Legendre (2009)) using the Indicator, or index, Value (IndVal) (De Cáceres et al. 2010). The Indicator Value was calculated according to the method proposed by Dufrene and Legendre (1997). This value was then tested for statistical significance by means of permutations (999 repetitions). Further explorations of species ecological preferences was performed using Multilevel Pattern Analysis with the multipatt fuction (De Cáceres et al. 2010), based on correlation indices and the Pearson’s phi coefficient of association (Chytrý et al. (2002), De Cáceres and Legendre (2009)). This coefficient is a measure of the correlation between two binary vectors. Phi was based on the presence–absence community matrix (De Cáceres et al. 2010) and corrected for unequal group sizes (Tichy and Chytry 2006).\nTo summarize the contribution of site environmental variables to species composition we performed distance-based Redundancy Analysis (dbRDA; Legendre and Anderson (1999)), implemented by the vegan R package (Oksanen et al. 2020), between each group of environmental variables (explanatory predictors) (site morphology, water quality, sediment composition and marginal habitat structure) and the community composition density matrix (response matrix) to see which environmental/habitat variables were the most important for determining each benthic community composition (Lanés et al. 2018). Multicollinearity across explanatory (environmental) variables was assessed using the Variance Inflation Factor (VIF) function (vif.cca). Highly collinear variables (VIF > 10) were excluded from the final model. Model significance was evaluated using permutation-based Analysis of Variance (ANOVA) (999 permutations) (Oksanen et al. 2020). To identify a parsimonious model, forward and backward stepwise model selection based on permutation tests was applied, retaining only predictors that significantly explained additional variation in community structure. The final RDA model was re-fitted using the selected variables and re-evaluated for collinearity and significance. Both sequential (Type I) and marginal (Type III) permutation tests were conducted, with marginal effects used to infer the independent contribution of each predictor.\nRDA was applied to the density community matrix after being transformed by the Hellinger transformation (Legendre and Gallagher 2001). Site morphology and water quality variables were square root transformed, whereas sediment composition and the marginal habitat structure (which were measured as percentages) were arcsine square-root transformed after relativization by column total (McCune and Grace 2002). Only taxa with the highest absolute scores on the first canonical axis were labeled in the final ordination diagram. All statistical analyses were performed in the statistical environment of R v.2.9.0 (Team 2017).\n\n\nRedundancy Analysis data organization and transformation\n#BENTOS2006 - RDA - ORGANIZANDO DADOS----\n#####....----\n\n##ORGANIZANDO DADOS----\n\ndev.off() #apaga os graficos, se houver algum\nrm(list=ls(all=TRUE)) #limpa a memória\ncat(\"\\014\") #limpa o console\n\nt_grps <- read.csv(\"t_grps.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_dens <- read.csv(\"m_dens.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_hab_part <- read.csv(\"m_hab_part.csv\",\n                       sep = \";\", dec = \".\",\n                       row.names = 1,\n                       header = TRUE,\n                       na.strings = NA)\nm_trns <- read.csv(\"m_com_trns.csv\",\n                       sep = \";\", dec = \".\",\n                       row.names = 1,\n                       header = TRUE,\n                       na.strings = NA)\n\nlibrary(vegan)\nlibrary(tidyverse)\n\n##SELECIONANDO VARIÁVEIS DE INTERESSE----\n\n#Lista as colunas\ncolnames(m_hab_part)\n# Escolher quais colunas usar por nome\n##colnames(m_hab_part)[rev(order(colSums(m_hab_part)))] #ordena por maior soma\n# Usar a função subset()\n#m_m <- subset(m_hab_part[, c(\"g.river_length\", \"g.altitude\", \"m.depth_hab\", \"m.depth_max\", \"m.slope\", \"m.width\")])\n##m_part <- subset(m_hab_part[, 7:10])\n##m_part <- m_hab_part[, c(\"q.w_vel\", \"q.temp\", \"q.do\", \"q.turb\")]\nm_h <- m_hab_part[, grep(\"^h\", colnames(m_hab_part))]\ncolnames(m_h) <- sub(\"^..\", \"\", colnames(m_h))\n# Tranformando/relativizando\nm_q <- sqrt(m_q)\nm_h <- asin(sqrt(decostand(m_h, method=\"total\", MARGIN = 2)))\n\nwrite.table(m_h, \"m_h.txt\")"
  },
  {
    "objectID": "index.html#environmental-variables",
    "href": "index.html#environmental-variables",
    "title": "Predictors of the macroinvertebrate fauna in semiarid aquatic systems",
    "section": "3.1 Environmental variables",
    "text": "3.1 Environmental variables\nThe study sites showed a wide array of environmental features, as expected from their different types (Figure 9). Water flow was present only in smaller streams in lower altitudes (sites 4-6) and during the rainy season (0.10-0.17 m/s). Stream sites tended to be narrower with widths ranging from 5.4 to 29.6 m, compared with 72.2 to 330 m for reservoirs. Littoral depths varied widely from 4.7 to 81.3 cm across all sites. Dissolved oxygen (DO) ranged from 1.8 to 9.4 mg/L and temperatures from 24.0 and 35.2 °C. Turbidity was low with Secchi depths reaching 90 cm, even though some sites had depths as low as 16 cm of the Secchi disk. Mud and sand were the main substrates across all sampled sites (with average covers of 54.4 and 37.9%, respectively). The habitat elements that gave greater overall contributions were attached and filamentous algae (12% on average), littoral grass (9.0%) and aquatic macrophytes (8.4%), but these contributions varied widely across sites and season (Figure 9) (detailed information on the study sites has been published elsewhere by Medeiros et al. (2008) and Medeiros et al. (2024).\n\n\nCode: Environment data table\n#TABELA DE HABITAT----\n\nlibrary(dplyr)\nlibrary(tidyr)\nm_trab <- m_hab_part %>%\n  rename_with(~ gsub(\"_\", \".\", .))\nm <- m_trab %>%\n  group_by(Area = t_grps$area,\n           Habitat = t_grps$ambiente,\n           Ponto = t_grps$UA) %>%\n  summarise(across(where(is.numeric),\n                   list(mean = mean, min = min, max = max)),\n            .groups = 'drop') %>%\n  pivot_longer(\n    cols = -c(Area, Habitat, Ponto),\n    names_to = c(\"Variable\", \".value\"),\n    names_sep = \"_\"\n  )\n\nm <- as.data.frame(m)\nm_wide <- m %>%\n  mutate(stat_string = ifelse(Variable == c(\"q.w.vel\"),\n                              paste0(round(mean, 3), \" (\", round(min, 3), \"-\", round(max, 3), \")\"),\n                              paste0(round(mean, 1), \" (\", round(min, 1), \"-\", round(max, 1), \")\"))) %>%\n  unite(\"Location\", Area, Habitat, Ponto, sep = \"_\") %>%\n  select(Variable, Location, stat_string) %>%\n  pivot_wider(names_from = Location, values_from = stat_string)\n\nm_wide\nm_wide <- as.data.frame(m_wide)\nm_wide\n\n# Salvado m_wide\nwrite.table(m_wide, \"m_wide_hab.txt\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\nm_wide_hab <- read.table(\"m_wide_hab.txt\",\n                  sep = \";\", dec = \".\",\n                  row.names = 1,\n                  header = TRUE,\n                  na.strings = NA)\n\n# Exportando dados para Excel\nlibrary(openxlsx)\n#write.xlsx(m_wide, file = \"tabela de habitat.xlsx\", rowNames = FALSE)\nwb <- loadWorkbook(\"tabela de habitat.xlsx\")\nwriteData(wb, sheet = \"Sheet 1\", x = m_wide)\nsaveWorkbook(wb, \"tabela de habitat.xlsx\", overwrite = TRUE)\n\n\n\n\nCode: Environment data variable summary\n# Escolher sumário de uma variavel\nm\nvar <- \"h.roots\"\nm[m$Variable == var, \"mean\"] #cada valor de var\nsummary(m[m$Variable == var, \"mean\"]) #sumário dos valores de var\n\n# Escolher sumário de um grupo de variáveis do df m\nvars <- unique(grep(\"^h\\\\.\", m$Variable, value = TRUE))\nsummaries <- list() #criam uma lista vazia para guardar os sumários\n# Loop para cada variável do grupo e guarda em summaries\nfor (var in vars) {\n  summaries[[var]] <- summary(m[m$Variable == var, \"mean\"])\n}\n#var is a temporary variable used in the for loop to iterate through\n#each variable name that starts with \"h.\"\n\nsummaries\nsummary_table <- do.call(rbind, lapply(summaries, as.data.frame.list))\nround(summary_table, 2)\n#sink(file = \"summary_h.txt\", split = TRUE)\nround(summary_table[order(summary_table$Mean, decreasing = FALSE), ], 2)\n#sink()\n\n# Tabela limpa\n#summary_table <- cbind(Variable = rownames(summary_table), summary_table)\n#rownames(summary_table) <- NULL\n#colnames(summary_table) <- c(\"Variable\", \"Min\", \"Q1\", \"Median\", \"Mean\", \"Q3\", \"Max\")\n#summary_table\n\n\n\n\nCode: Environment data GT table\nlibrary(readr)\nlibrary(dplyr)\nlibrary(gt)\n\nm_wide_hab <- read.table(\"m_wide_hab.txt\",\n                  sep = \";\", dec = \".\",\n                  row.names = 1,\n                  header = TRUE,\n                  na.strings = NA)\n\n#m_mapa <- read_tsv(\"column_labels.txt\", show_col_types = FALSE)\ndados <- m_wide_hab\ndados\nnomes <- names(dados)[-1]\nnomes\n\ndf_nomes <- data.frame(\n  original = nomes,\n  final    = nomes,\n  stringsAsFactors = FALSE)\n\ndf_nomes\ndf_nomes$final <- gsub(\"_\", \"<br>\", df_nomes$final)\ndados <- mutate(dados,across(-Variable, ~ gsub(\" \\\\(\", \"<br>(\", .)))\n#fix(df_nomes)\n#write.table(df_nomes, \"df_nomes.txt\")\ndf_nomes <- read.table(\"df_nomes.txt\")\n\nlabels_finais <- setNames(\n  lapply(df_nomes$final, md),\n  nomes)\n\ntabela_gt <- dados %>%\n  gt(rowname_col = \"Variable\") %>%\n#  tab_header(\n#    title = \"Características Ambientais\",\n#    subtitle = \"Valores apresentados como média (mín–máx)\"\n#  ) %>%\n  fmt_markdown(\n    columns = -Variable) %>%\n  cols_align(\n    align = \"right\",\n    columns = -Variable) %>%\n  cols_label(.list = labels_finais)\n\ntabela_gt\ngtsave(tabela_gt, \"gt-hab_gttable.html\")\ngtsave(tabela_gt, \"fig-hab_gttable.png\")\nsaveRDS(tabela_gt, \"gt-hab_gttable.rds\")\n\n# Tabela final ajustada no Excel\nlibrary(readxl)\nhab_gttable <- read_excel(\n  path  = \"tabela de habitat.xlsx\",\n  sheet = \"tabela_final\",\n  range = \"C1:J27\")\nhab_gttable\nlibrary(gt)\nhab_gttable <- gt(hab_gttable)\nhab_gttable <- sub_missing(hab_gttable,\n                      columns = everything(), missing_text = \"\")\n#hab_gttable <- fmt_number(hab_gttable, columns = \"F.O.(%)\", decimals = 1)\nhab_gttable\ngtsave(hab_gttable, \"gt-hab_gttable_xlsx.html\")\nsaveRDS(hab_gttable, \"gt-hab_gttable_xlsx.rds\")\n\n\nPrincipal Component Analysis described the overall structure of the study sites and the most important features in separating them in terms of their physical and chemical variables, site morphometry, sediment composition, and marginal habitat structure (Figure 1). PCA explained 41.9% of the variance in the environmental variables, with the first axis (27.6%) showing a gradient from large reservoirs to smaller streams sites. Large scale morphology variables such as altitude, river length and site width were important to describe most reservoirs, whereas river sites were better described by local physical, chemical and habitat variables, such as water velocity, dissolved oxygen, temperature and overhanging vegetation. Larger reservoirs were mostly associated with a muddy substrate whereas river sites included a more diverse array of substrates including sand, rocks and gravel and cobbles. Other variables such as submerged vegetation and leaf litter (habitat structure), and slope (morphology) were important in explaining specific sites at given sampling occasions.\n\n\nEnvironment data PCA - fviz\n#PCA fviz package----\n#browseURL(\"https://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/\")\n\n#ORGANIZANDO DADOS----\n\ndev.off()\nrm(list=ls(all=TRUE))\ncat(\"\\014\")\n\nt_grps <- read.csv(\"t_grps.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_hab_part <- read.csv(\"m_hab_part.csv\",\n                  sep = \";\", dec = \".\",\n                  row.names = 1,\n                  header = TRUE,\n                  na.strings = NA)\n\ncolnames(m_hab_part)\n#fix(m_hab_part)\n\n###RELATIVIZAÇÕES E TRANSFORMAÇÕES----\nm_hab_trns <- sqrt(m_hab_part)\n#m_hab_trns[m_hab_trns == -Inf] <- 0\n#m_hab_trns$g.altitude <- NULL #DELETA COLUNA\n\n# Salvado m_hab_trns\nwrite.table(m_hab_trns, \"m_hab_trns.csv\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\nm_hab_trns <- read.table(\"m_hab_trns.csv\",\n                  sep = \";\", dec = \".\",\n                  row.names = 1,\n                  header = TRUE,\n                  na.strings = NA)\n\n#PCA----\n\nlibrary(\"FactoMineR\")\nlibrary(\"factoextra\")\n\npca <- PCA(m_hab_trns, scale.unit = TRUE, ncp = 5, graph = TRUE)\nprint(pca)\n\neig.val <- get_eigenvalue(pca)\neig.val\n\nsink(file = \"cor_matrix.txt\", append = FALSE)\npca$var$cor\nsink()\n\nfviz_eig(pca, addlabels = TRUE, ylim = c(0,30))\n\nvar <- get_pca_var(pca)\nvar\n\nfviz_pca_var(pca, col.var = \"black\")\n\nlibrary(\"corrplot\")\ncorrplot(var$cos2, is.corr=FALSE)\n\nfviz_cos2(pca, choice = \"var\", axes = 1:2)\n\nfviz_pca_var(pca, col.var = \"cos2\",\n             gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n             repel = TRUE # Avoid text overlapping\n)\n\nfviz_pca_var(pca, alpha.var = \"cos2\")\n\ncorrplot(var$contrib, is.corr=FALSE)\n\nfviz_contrib(pca, choice = \"var\", axes = 1, top = 10)\nfviz_contrib(pca, choice = \"var\", axes = 2, top = 10)\nfviz_contrib(pca, choice = \"var\", axes = 1:2, top = 10)\n\nfviz_pca_var(pca, col.var = \"contrib\",\n             gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\")\n)\nfviz_pca_var(pca, alpha.var = \"contrib\")\n\n##GROUPING BY KMEANS----\n\nset.seed(123)\nres.km <- kmeans(var$coord, centers = 3, nstart = 25)\ngrp <- as.factor(res.km$cluster)\n# Color variables by groups\nfviz_pca_var(pca, col.var = grp,\n             palette = c(\"#0073C2FF\", \"#EFC000FF\", \"#868686FF\"),\n             legend.title = \"Cluster\")\n\nind <- get_pca_ind(pca)\nind\nind$contrib\n\n##BIPLOTS----\n\nfviz_pca_ind(pca)\n\nfviz_pca_ind(pca, col.ind = \"cos2\",\n             gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n             repel = TRUE #avoid text overlapping (slow if many points)\n)\n\nfviz_pca_ind(pca, pointsize = \"cos2\",\n             pointshape = 21, fill = \"#E7B800\",\n             repel = TRUE #avoid text overlapping (slow if many points)\n)\n\nfviz_pca_ind(pca, col.ind = \"cos2\", pointsize = \"cos2\",\n             gradient.cols = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n             repel = TRUE #avoid text overlapping (slow if many points)\n)\n\nfviz_cos2(pca, choice = \"ind\")\n\nfviz_contrib(pca, choice = \"ind\", axes = 1:2)\n\n# Create a random continuous variable of length 23,\n# Same length as the number of active individuals in the PCA\nnrow(m_hab_part)\nset.seed(123)\nmy.cont.var <- t_grps$ponto.n\nmy.cont.var\n# Color individuals by the continuous variable\nfviz_pca_ind(pca, col.ind = my.cont.var,\n             gradient.cols = c(\"blue\", \"yellow\", \"red\"),\n             legend.title = \"Cont.Var\",\n             repel = FALSE)\n\nfviz_pca_ind(pca,\n             geom.ind = \"point\", #show points only (nbut not \"text\")\n             col.ind = as.factor(my.cont.var), #color by groups\n             palette = \"grey\",\n             addEllipses = TRUE, #concentration ellipses\n             legend.title = \"Groups\"\n)\n\nlength(unique(my.cont.var))\nfviz_pca_ind(pca,\n             geom.ind = \"point\",\n             col.ind = t_grps$UA,\n             palette = \"grey\",\n             addEllipses = TRUE, ellipse.type = \"confidence\",\n             mean.point = TRUE,\n             legend.title = \"Groups\")\n\nfviz_pca_biplot(pca, repel = TRUE,\n                col.var = \"#2E9FDF\", #variables color\n                col.ind = \"#696969\"  #individuals color\n)\n\nfviz_pca_biplot(pca,\n                col.ind = t_grps$UA, palette = \"jco\",\n                addEllipses = TRUE, elipse.type = \"euclid\",\n                label = \"var\",\n                col.var = \"black\", repel = TRUE,\n                legend.title = \"Species\")\n\n#GRAFICO FINAL----\n\nfviz_pca_biplot(pca, repel = TRUE,\n                col.var = \"red\", #variables color\n                col.ind = \"black\"  #individuals color\n)\n\nlibrary(factoextra)\nlibrary(ggplot2)\n\n# Convert t_grps$UA to a factor to ensure distinct shapes\nt_grps$UA <- as.factor(t_grps$UA)\n\n# Generate the PCA biplot with individuals in black\nfviz_pca_biplot(pca, repel = TRUE,\n                            col.var = \"red\",  #cariables color\n                            col.ind = \"black\", #all individuals in black\n                            geom = c(\"point\", \"text\"))\n\n# Convert t_grps$UA to a factor to ensure distinct shapes\nt_grps$UA <- as.factor(t_grps$UA)\n\n# Generate the PCA biplot with individuals in black\nfviz_pca_biplot(pca, repel = TRUE,\n                            col.var = \"red\",  #variables color\n                            col.ind = \"black\", #all individuals in black\n                            geom = c(\"text\")) +  #remove default individuals\n  geom_point(aes(shape = t_grps$UA), size = 3) +  #map shapes to t_grps$UA\n  scale_shape_manual(values = c(15, 16, 0, 1, 2, 17)) +  #adjust shape values\n  theme_minimal()  #clean theme\n\n###FIX VARIABLES COORDINATES----\nvar_coords <- as.data.frame(pca$var$coord)\n# Manually adjust positions (modify values as needed)\n#var_coords$Dim.1 <- var_coords$Dim.1 * 4.7  #shift right\n#var_coords$Dim.2 <- var_coords$Dim.2 * 4.7  #shift up\n#Fine tunning\n#fix(var_coords)\n#write.table(var_coords, \"coords_var.txt\")\nvar_coords <- read.table(\"coords_var.txt\")\n#rownames(var_coords) <-\n#  substr(rownames(var_coords), 3, nchar(rownames(var_coords))) #remove os 2 primeiros caracteres\n\n###FIX INDIVIDUALS COORDINATES----\nind_coords <- as.data.frame(pca$ind$coord)\n# Manually adjust positions (modify values as needed)\n#ind_coords$Dim.1 <- ind_coords$Dim.1 + 0  #shift right\n#ind_coords$Dim.2 <- ind_coords$Dim.2 + 0.2  #shift up\n#Fine tunning\n#fix(ind_coords)\n#write.table(ind_coords, \"coords_ind.txt\")\nind_coords <- read.table(\"coords_ind.txt\")\n#rownames(ind_coords) <-\n#  substr(rownames(ind_coords), 5, nchar(rownames(ind_coords))) #remove os 4 primeiros caracteres\n\n#PLOT----\n\npng(\"fig-hab_PCA_fviz.png\", width = 11, height = 9, units = \"in\", res = 400)\nfviz_pca_biplot(pca, repel = FALSE,\n                col.var = \"red\", col.ind = \"black\",\n                geom = \"none\", #remove default labels\n                label = \"none\") +  #remove both variable & individual labels\n# Add manually adjusted variable labels\n  geom_text(data = var_coords, aes(x = Dim.1, y = Dim.2, label = rownames(var_coords)),\n            color = \"red\", size = 4) +\n# Add manually adjusted individual labels\n  geom_text(data = ind_coords, aes(x = Dim.1, y = Dim.2, label = rownames(ind_coords)),\n            color = \"black\", size = 4, nudge_x = 0, nudge_y = 0) +  #corrected column names\n  geom_point(aes(shape = t_grps$UA), size = 3) + #map shapes to t_grps$UA\n  scale_shape_manual(values = c(15, 16, 0, 1, 2, 17)) +\n  theme_minimal() + ggtitle(NULL) + labs(shape = \"Sites\") +\n  theme(legend.text = element_text(size = 14),  #increase legend text size\n        legend.title = element_text(size = 16)) +  #increase legend title size\n  guides(shape = guide_legend(override.aes = list(size = 4))) #increase legend symbols\ndev.off()"
  },
  {
    "objectID": "index.html#benthic-macroinvertebrates",
    "href": "index.html#benthic-macroinvertebrates",
    "title": "Predictors of the macroinvertebrate fauna in semiarid aquatic systems",
    "section": "3.2 Benthic macroinvertebrates",
    "text": "3.2 Benthic macroinvertebrates\nA total amount of 28155 individuals was collected, divided into 32 taxonomic groups. Out of these, Thiaridae (1340.15 ind./m2 ± 3068.95), larvae of Chironomidae (629.07 ind./m2 ± 1424.72), and Oligochaeta (380.49 ind./m2 ± 856.62) were the most the representative (Figure 10).\n\n\nCommunity structure data table\n#BENTOS2006 - ESTR. DA COMUNIDADE----\n#####....----\n\n##ORGANIZANDO DADOS----\n\ndev.off() #apaga os graficos, se houver algum\nrm(list=ls(all=TRUE)) #limpa a memória\ncat(\"\\014\") #limpa o console\n\nt_grps <- read.csv(\"t_grps.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_dens <- read.csv(\"m_dens.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_hab_part <- read.csv(\"m_hab_part.csv\",\n                  sep = \";\", dec = \".\",\n                  row.names = 1,\n                  header = TRUE,\n                  na.strings = NA)\nm_cont <- read.csv(\"m_cont.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\n\nlibrary(tibble)\nlibrary(tidyverse)\nlibrary(forcats)\nlibrary(openxlsx)\nlibrary(Rcpp)\n\nm_dens\nstr(m_dens)\nm_trab <- m_dens\n\nm_trab <- (m_trab) #SITES\nm_trab <- t(m_trab) #SPP\n\n##TAMANHO DA MATRIZ----\n\nrange(m_trab) #menor e maior valores\nlength(m_trab) #no. de colunas\nncol(m_trab) #no. de N colunas\nnrow(m_trab) #no. de M linhas\nsum(lengths(m_trab)) #soma os nos. de colunas\nlength(as.matrix(m_trab)) #tamanho da matriz m x n\nsum(m_trab == 0) #número de observações igual a zero\nsum(m_trab > 0) #número de observações maiores que zero\n#calculando a proporção de zeros na matriz\nzeros <- (sum(m_trab == 0)/length(as.matrix(m_trab)))*100\nzeros\n\n##ESTRUTURA DA COMUNIDADE----\n\nSum <- rowSums(m_trab)\n#ou\nSum <- apply(m_trab,1,sum)\nSum\n# Abundância relativa (%)\nRA <- (Sum / sum(Sum)) * 100 # percentage\n# Media\nMean <- rowMeans(m_trab)\nMean\n# Ou\nMean <- apply(m_trab,1,mean)\nMean\n# Desvio padrão\nDP <- apply(m_trab,1,sd)\nDP\n# Máximo\nMax <- apply(m_trab,1,max)\nMax\n# Mínimo\nMin <- apply(m_trab,1,min)\nMin\n# Mínimo não-zero\nMinZ <- apply(m_trab, 1, function(row) {\n  non_zero_values <- row[row > 0]  # Filter out zero values\n  if (length(non_zero_values) == 0) {\n    return(0)  # If all values are zero, return 0\n  } else {\n    return(min(non_zero_values))  # Return the minimum of non-zero values\n  }\n})\nMinZ\n\nm_pa <- m_trab\nm_pa[m_pa != 0] <- 1\nrowSums(m_pa)\nlibrary(vegan)\nbin <- decostand(m_trab,\"pa\")\nbin[1:10, 1:10]\nS <- apply(bin,1,sum)\nS\n#OU\nRiqueza <- specnumber(m_trab)\nRiqueza\nRiqueza_total <- specnumber(colSums(m_trab))\nRiqueza_total\n\nFO <- rowSums(m_trab > 0) / ncol(m_trab) * 100\nFO\n\nH <- diversity(m_trab, index = \"shannon\")\nH\nD <- diversity(m_trab, \"simpson\")\nD\nD[is.na(D)] <- 0 #substitui NA ou NaN por 0\nD\nE <- H/log(specnumber(m_trab))\nE\nE[is.na(E)] <- 0 #substitui NA ou NaN por 0\nE\n\n###DESCRITORES----\nDescritores1 <- cbind(Sum, RA, Mean, DP, Max, Min, MinZ, FO, S, E, H, D)\nDescritores1 <- as.data.frame(Descritores1)\nDescritores1\nDescritores1 <- Descritores1[order(-Descritores1$Mean), ] #ordena do maio para o menor \"-\"\n#Descritores1 <- Descritores1 %>% rownames_to_column(var=\"Espécies\") #da nome a primeira coluna\nSomaTotalD <- apply(Descritores1,2,sum)\nSomaTotalD\nMediaTotalD <- apply(Descritores1,2,mean)\nMediaTotalD\nDPTotalD <- apply(Descritores1,2,sd)\nDPTotalD\nDescritores2 <- cbind(SomaTotalD, MediaTotalD, DPTotalD)\nDescritores2 <- as.data.frame(Descritores2)\nDescritores2 <- t(Descritores2)\nDescritores2\nDescritoresFinal <- rbind(Descritores1, Descritores2)\nDescritoresFinal\nDescritoresFinal <- round (DescritoresFinal, 2)\nDescritoresFinal\n\n# Salvando DescritoresFinal\nwrite.table(data.frame(\"Spp\"=rownames(DescritoresFinal),\n                       DescritoresFinal),\n            \"DescritoresSPP.txt\",\n            row.names=FALSE,\n            sep=\"\\t\")\n\n###TABELA FINAL DESCRITORES----\nlibrary(gt)\ndf <- DescritoresFinal\nncol(df); nrow(df) #no. de N colunas x M linhas\ndf <- cbind(Spp = rownames(df), df)\ngt <- gt(df, rowname_col = \"Espécie\",\n   caption = \"Descritores da diversidade por espécie (colunas). Sum, soma; RA, abundância relativa (%); mean, média; DP, desvio padrão da média; Max, maior valor; Min, menor valor; MinZ, menor valor não zero; FO, frequência de ocorrência (%); S, riqueza (ou no. de ocorrências, da matriz transposta); E, índice de equitabilidade de Pielou; H, índice de diversidade de Shannon; D, índice de diversidade de Simpson.\")\ngt\ngtsave(gt, \"DescritoresSPP.html\")\ngtsave(gt, \"DescritoresSPP.png\")\n\n###NORMALIDADE----\nlibrary(moments)\nAssimetria <- apply(m_trab,1,skewness)\nAssimetria\nCurtose <- apply(m_trab,1,kurtosis)\nCurtose\nNormalidade1 <- cbind(Assimetria, Curtose)\nNormalidade1 <- as.data.frame(Normalidade1)\nNormalidade1\nSomaTotalN <- apply(Normalidade1,2,sum)\nSomaTotalN\nMediaTotalN <- apply(Normalidade1,2,mean)\nMediaTotalN\nDPTotalN <- apply(Normalidade1,2,sd)\nDPTotalN\nNormalidade2<-cbind(SomaTotalN, MediaTotalN, DPTotalN)\nNormalidade2<-as.data.frame(Normalidade2)\nNormalidade2 <- t(Normalidade2) #\"t\" transpoe a matriz\nNormalidade2\nNormalidadeFinal <- rbind(Normalidade1, Normalidade2)\nNormalidadeFinal\nNormalidadeFinal <- round(NormalidadeFinal, 2)\nNormalidadeFinal\n\n# Salvando NormalidadeFinal\nwrite.table(data.frame(\"Spp\"=rownames(NormalidadeFinal),\n                       NormalidadeFinal),\n            \"NormalidadeSPP.txt\",\n            row.names=FALSE,\n            sep=\"\\t\")\n\n###TABELA FINAL NORMALIDADE----\nnf <- NormalidadeFinal\nncol(nf); nrow(nf) #no. de N colunas x M linhas\nnf <- cbind(Spp = rownames(nf), nf)\ngt <- gt(nf, rowname_col = \"Site\", caption = \"Descritores da normalidade por espécie (coluna)\")\ngt\ngtsave(gt, \"NormalidadeSPP.html\")\n\n#DIVERSIDADE EM DENSIDADE MATRIZ NÃO-TRANSPOSTA----\n\n# Números de Hill\nHill <- renyi(m_trab,\n              scales = c(0:5),\n              hill = TRUE)\nHill\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(tidyverse)\ngrafico1 <- Hill %>%\n  rownames_to_column() %>%\n  pivot_longer(-rowname) %>%\n  mutate(name = factor(name, name[1:length(Hill)])) %>%\n  ggplot(aes(x = name, y = value, group = rowname,\n             col = rowname)) +\n  geom_point(size = 2) +\n  geom_line(size = 1) +\n  xlab(\"Parâmetro de ordem de diversidade (q)\") +\n  ylab(\"Diversidade\") +\n  labs(col = \"Locais\") +\n  theme_bw() +\n  theme(text = element_text(size = 10)) #ajustar a fonte caso nao caiba no output html\ngrafico1\nggsave(grafico1, dpi = 300, filename = \"fig-hill.png\")\n\n# Gráfico de abunância\nabund <- colSums(m_trab)\n#abund <- m_trab[1, ] #escolhe a primeira linha para a distribuição de abundância\ndf <- data.frame(sp = colnames(m_trab),\n                 abun = abund)\ngrafico2 <- ggplot(df, aes(fct_reorder(sp, -abun),\n                           abun, group = 1)) +\n  geom_col() +\n  geom_line(col = \"red\", linetype = \"dashed\") +\n  geom_point(col = \"red\") +\n  xlab(\"Espécies\") +\n  ylab(\"Abundância\") +\n  theme_bw() +\n  theme(axis.text.x = element_text(\n    angle = 45,\n    hjust = 1,\n    face = \"italic\",\n    size = 10),\n    axis.text.y = element_text(size = 10),\n    axis.title.x = element_text(size = 12),\n    axis.title.y = element_text(size = 12))\ngrafico2\nggsave(grafico2, dpi = 300, filename = \"fig-abun.png\")\n\n# Curvas de rarefação\nm_trab_r <- mutate(as.data.frame(m_trab), across(everything(), ceiling)) #arredonda a matriz original para números inteiros\ncolSums(t(m_trab_r))\ncolnames(t(m_trab_r))\n#rarefa <- t(m_trab_r[c(\"S-R-CT2\",\"S-R-CP2\",\"S-A-TA2\",\"B-A-MU2\"),]) #curva de rarefação para os sítios especificados\nclass(m_trab)\n\n# Curva de rarefação para todos os sítios\nrarefa <- t(m_trab_r)\n## Curva de rarefação para as 8 UA's com maior soma\n#m_trab_r <- as.data.frame(t(m_trab_r)) #transpõe a matriz\n#col_sums <- colSums(m_trab_r)\n#largest_columns <- names(sort(col_sums, decreasing = TRUE)[1:8])\n#rarefa <- m_trab_r[largest_columns] #curva de rarefação para as 8 UA's com maior soma\nlibrary(iNEXT)\nout <- iNEXT(rarefa, q = 0,\n             datatype = \"abundance\",\n             size = NULL,\n             endpoint = 2000, #define o comprimento de eixo x\n             knots = 40,\n             se = TRUE,\n             conf = 0.95,\n             nboot = 50)\ngrafico3 <- ggiNEXT(out, type = 1, facet.var=\"None\") +\n  theme_bw() +\n  labs(fill = \"Áreas\") +\n  xlab(\"Número de indivíduos\") +\n  ylab(\"Riqueza de espécies\") +\n  theme(legend.title=element_blank()) #ver como fica com facet.var=\"Assemblage\"\n#grafico3\n#ggsave(grafico3, dpi = 300, filename = \"fig-rare1.png\")\n\n# Curvas de acumulação de espéces\nacumula <- specaccum(m_trab,\n                     method = \"random\")\nacumula\nplot(acumula)\nplot_data <- data.frame(\"UAs\" = c(0, acumula$sites),\n                        \"Riqueza\" = c(0, acumula$richness),\n                        \"lower\" = c(0, acumula$richness - acumula$sd),\n                        \"upper\" = c(0, acumula$richness + acumula$sd))\ngLocais <- ggplot(plot_data, aes(x = UAs, y = Riqueza)) +\n  geom_point(color = \"blue\", size = 4) +\n  geom_line(color = \"blue\", lwd = 2) +\n  geom_ribbon(aes(ymin = lower, ymax = upper),\n              linetype=2, alpha=0.3, fill = \"yellow\") +\n  ylab(\"Riqueza acumulada\") +\n  theme_classic() +\n  theme(text = element_text(size = 16))\ngLocais\nggsave(gLocais, dpi = 300, filename = \"fig-acum.png\")\nplot_data <- data.frame(\"Individuos\" = c(0, acumula$individuals),\n                        \"Riqueza\" = c(0, acumula$richness),\n                        \"lower\" = c(0, acumula$richness - acumula$sd),\n                        \"upper\" = c(0, acumula$richness + acumula$sd))\ngInd <- ggplot(plot_data, aes(x = Individuos, y = Riqueza)) +\n  geom_point(color = \"blue\", size = 4) +\n  geom_line(color = \"blue\", lwd = 2) +\n  geom_ribbon(aes(ymin = lower, ymax = upper),\n              linetype=2, alpha=0.3, fill = \"yellow\") +\n  ylab(\"Riqueza acumulada\") +\n  theme_classic() +\n  theme(text = element_text(size = 16))\ngInd\n\n##TABELA DA COMUNIDADE----\n\nlibrary(dplyr)\nlibrary(tidyr)\nm_trab <- m_dens %>%\n  rename_with(~ gsub(\"_\", \".\", .))\nm <- m_trab %>%\n  group_by(Area = t_grps$area,\n           Habitat = t_grps$ambiente,\n           Ponto = t_grps$UA) %>%\n  summarise(across(where(is.numeric),\n                   list(mean = mean, sd = sd)),\n            .groups = 'drop') %>%\n  pivot_longer(\n    cols = -c(Area, Habitat, Ponto),\n    names_to = c(\"Variable\", \".value\"),\n    names_sep = \"_\"\n  )\nm\nm <- as.data.frame(m)\nm_wide <- m %>%\n  mutate(stat_string = ifelse(\n    Variable == \"nome_da_variavel\",  #escolhe uma variável pra ter 3 casas decimais\n    paste0(round(mean, 3), \" (\", round(sd, 3), \")\"),\n    paste0(round(mean, 1), \" (\", round(sd, 1), \")\")\n  )) %>%\n  unite(\"Location\", Area, Habitat, Ponto, sep = \"_\") %>%\n  dplyr::select(Variable, Location, stat_string) %>% #dplyr dá conflito com MASS\n  pivot_wider(names_from = Location, values_from = stat_string)\n\nm_wide\nm_wide <- as.data.frame(m_wide)\nm_wide\n\n# Salvado m_wide\nwrite.table(m_wide, \"m_wide_spp.txt\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\nm_wide_spp <- read.table(\"m_wide_spp.txt\",\n                  sep = \";\", dec = \".\",\n                  row.names = 1,\n                  header = TRUE,\n                  na.strings = NA)\n\n# Exportando dados para Excel\nlibrary(openxlsx)\n#write.xlsx(m_wide_spp, file = \"tabela da comunidade.xlsx\", rowNames = FALSE)\nwb <- loadWorkbook(\"tabela da comunidade.xlsx\")\nwriteData(wb, sheet = \"Sheet 1\", x = m_wide_spp)\nsaveWorkbook(wb, \"tabela da comunidade.xlsx\", overwrite = TRUE)\n\n\n\n\nCode: Community structure variable summary\n# Escolher sumário de uma variavel\nm\nvar <- \"h.roots\"\nm[m$Variable == var, \"mean\"] #cada valor de var\nsummary(m[m$Variable == var, \"mean\"]) #sumário dos valores de var\n\n# Escolher sumário de um grupo de variáveis do df m\nvars <- unique(grep(\"^h\\\\.\", m$Variable, value = TRUE))\nsummaries <- list() #criam uma lista vazia para guardar os sumários\n# Loop para cada variável do grupo e guarda em summaries\nfor (var in vars) {\n  summaries[[var]] <- summary(m[m$Variable == var, \"mean\"])\n}\n#var is a temporary variable used in the for loop to iterate through\n#each variable name that starts with \"h.\"\n\nsummaries\nsummary_table <- do.call(rbind, lapply(summaries, as.data.frame.list))\nround(summary_table, 2)\n#sink(file = \"summary_h.txt\", split = TRUE)\nround(summary_table[order(summary_table$Mean, decreasing = FALSE), ], 2)\n#sink()\n\n# Tabela limpa\n#summary_table <- cbind(Variable = rownames(summary_table), summary_table)\n#rownames(summary_table) <- NULL\n#colnames(summary_table) <- c(\"Variable\", \"Min\", \"Q1\", \"Median\", \"Mean\", \"Q3\", \"Max\")\n#summary_table\n\n\n\n\nCode: Community structure GT table\nlibrary(readr)\nlibrary(dplyr)\nlibrary(gt)\n\n#m_mapa <- read_tsv(\"column_labels.txt\", show_col_types = FALSE)\ndados <- m_wide_spp\ndados\nnomes <- names(dados)[-1]\nnomes\n\ndf_nomes <- data.frame(\n  original = nomes,\n  final    = nomes,\n  stringsAsFactors = FALSE)\n\ndf_nomes\ndf_nomes$final <- gsub(\"_\", \"<br>\", df_nomes$final)\ndados <- mutate(dados,across(-Variable, ~ gsub(\" \\\\(\", \"<br>(\", .)))\n#fix(df_nomes)\n#write.table(df_nomes, \"df_nomes.txt\")\ndf_nomes <- read.table(\"df_nomes.txt\")\n\nlabels_finais <- setNames(\n  lapply(df_nomes$final, md),\n  nomes)\n\ntabela_gt <- dados %>%\n  gt(rowname_col = \"Variable\") %>%\n#  tab_header(\n#    title = \"Características Ambientais\",\n#    subtitle = \"Valores apresentados como média (mín–máx)\"\n#  ) %>%\n  fmt_markdown(\n    columns = -Variable) %>%\n  cols_align(\n    align = \"right\",\n    columns = -Variable) %>%\n  cols_label(.list = labels_finais)\n\ntabela_gt\ngtsave(tabela_gt, \"gt-spp_gttable.html\")\ngtsave(tabela_gt, \"fig-spp_gttable.png\")\n\n# Tabela final ajustada no Excel\nlibrary(readxl)\nspp_gttable <- read_excel(\n  path  = \"tabela da comunidade.xlsx\",\n  sheet = \"tabela_final\",\n  range = \"C1:J48\")\nspp_gttable\nlibrary(gt)\nspp_gttable <- gt(spp_gttable)\nspp_gttable <- sub_missing(spp_gttable,\n                      columns = everything(), missing_text = \"\")\nspp_gttable <- fmt_number(spp_gttable,\n                          columns = \"F.O.(%)\", decimals = 1)\nspp_gttable\ngtsave(spp_gttable, \"gt-spp_gttable_xlsx.html\")\nsaveRDS(spp_gttable, \"gt-spp_gttable_xlsx.rds\")\n\n\nSampling sites were different in macroinvertebrate rarefied richness (ANOVA d.f.= 5, 16; Frichness = 6.9; p=0.001) but not in density of individuals (ANOVA d.f.= 5, 16; Fdensity = 2.06; p = 0.124). According to post hoc Turkey tests, Cipó stream and the Recando reservoir had significantly higher rarefied richness when compared to the other study sites (p < 0.05) (Figure 2).\n\n\nCommunity structure univariate comparisons\n#BENTOS2006 - RAREFAÇÃO E ANOVAS----\n#####....----\n\n#ORGANIZANADO DADOS----\n\ndev.off() #apaga os graficos, se houver algum\nrm(list=ls(all=TRUE)) #limpa a memória\ncat(\"\\014\") #limpa o console\n\nm_cont <- read.csv(\"m_cont.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_cont\n\n##RAREFAÇÃO BASEADA EM CONTAGEM----\n\nlibrary(vegan)\ndata <- m_cont\nS <- specnumber(data) #observed number of species\nS\n#raremax <- min(rowSums(data))\nraremax <- round(mean(rowSums(data)))\n#raremax <- 1000\nraremax\nSrare <- rarefy(data, raremax)\nSrare\nplot(S, Srare, xlab = \"Observed No. of Species\", ylab = \"Rarefied No. of Species\")\nabline(0, 1)\npng(\"fig-rarecurve.png\")\nrarecurve(data, step = 20, sample = raremax, col = \"blue\", cex = 0.6,\n          xlab = \"Sample size\", ylab = \"Taxa\", xlim = c()) #c(0,5000)\ndev.off()\n\n##ANOVAS----\n\nanovas <- cbind(Srare = Srare, m_cont)\nanovas <- anovas[,1, drop = FALSE]\nanovas\nm_dens <- read.csv(\"m_dens.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_dens\nanovas$dens <- rowMeans(m_dens, na.rm = TRUE)\nanovas\nS <- specnumber(m_dens)\nanovas$S <- S\nanovas\nS\n\n###CRIANDO GRUPOS----\nlibrary(tidyverse)\nanovas <- cbind(Grupos = rownames(anovas), anovas)\nanovas\ngrps <- substr(anovas[, 1], 5,6)\ngrps\nanovas <- mutate(anovas, Grupos = c(grps))\nanovas\n\n###SALVANDO MATRIZ FINAL ANOVAS----\nwrite.table(anovas, \"t_anovas.csv\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\nanovas <- read.csv(\"t_anovas.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nanovas\n\n##ANOVA----\n\nsink(file = \"anovas.txt\", split = T)\nanova <- aov(Srare ~ Grupos, data = anovas)\nanova\nsummary(anova)\nTukeyHSD(anova)\n\n###RESUMO DO TUKEY----\ntukey <- TukeyHSD(anova)\ntukey_df <- as.data.frame(tukey$Grupos)\ntukey_df$Comparison <- rownames(tukey_df)\nsignificant <- subset(tukey_df, `p adj` < 0.05)\nprint(significant)\nsink()\n\n##ANOVA PLOT----\n\nlevels(anovas$Grupos)  #to check existing levels\nanovas$Grupos <- factor(anovas$Grupos,\n                        levels = c(\"MU\", \"SA\", \"EP\", \"RE\", \"CI\", \"SE\")) #define a ordem\n#anovas %>%\n#  group_by(Grupos) %>%\n#  summarise(\n#    count = n(),\n#    mean = mean(Srare, na.rm = TRUE),\n#    sd = sd(Srare, na.rm = TRUE))\n\nrareplot <- ggplot(anovas, aes(x = Grupos, y = Srare)) +\n  geom_jitter(width = 0.2, alpha = 0.6, color = \"black\") +  # jittered points (small)\n  stat_summary(fun = mean, geom = \"point\", size = 4, color = \"black\") +  # large mean point\n  stat_summary(fun.data = mean_se, geom = \"errorbar\", width = 0.1, color = \"black\") +  # SE bars\n  labs(x = \"Study sites\", y = \"Rarefied richness\", title = \"\") +\n  theme_minimal()\nrareplot\nggsave(rareplot, dpi = 300, filename = \"fig-rarerich.png\", bg = \"white\")\n\n\nThe Stepwise Multiple Regression Model (SMRM) was applied separately for each of the four sets of environmental variables (morphology, water quality, sediment composition and marginal habitat structures). Site morphology variables retained only stream width, with the final model explaining 15.4% of the variation (Adjusted R2 = 0.111; d.f. = 1,20; F = 3.63, p = 0.071). Site width β = -0.36 (± 0.19), indicates that wider sites tend to have fewer species, although this effect was marginally significant (p = 0.071). River length had a strong negative effect on species richness (β = -1.96 ± 0.34), explaining 63.1% of its variation (Adjusted R2 = 0.612; d.f. = 1, 20; F = 34.15, p < 0.001). The SMRM that best explained the water quality variables (42.3% of the variation in rarefied species richness) included water velocity and water temperature as significant predictors (Adjusted R2 = 0.288; d.f. = 4,17; F = 3.12, p = 0.043). Water velocity (β = -19.97 ± 9.04) had a significant negative effect on species richness (p = 0.041) and water temperature (β = 16.11 ± 4.97) had a significant positive effect (p = 0.005). Dissolved oxygen and turbidity were not significant predictors (p > 0.05). Among the substrate composition variables, gravel was the only significant predictor, explaining 32.8% of the variation in rarefied species richness (Adjusted R2 = 0.294; d.f. = 1,20; F = 9.76, p = 0.005, β = 1.85 ± 0.59). The SMRM for the habitat variables explained 58.6% of the variation in rarefied species richness (Adjusted R2 = 0.379; d.f. = 7,14; F = 2.83, p = 0.046), with leaf litter (β = 6.24 ± 2.33, p = 0.018) and algal cover (β = 0.92 ± 0.41, p = 0.039) having significant positive effects on species richness. Other predictors such as roots (β = 4.71, p = 0.058) and littoral grass (β = -1.01, p = 0.052) may have been important showing marginal effects. Stepwise Multiple Regression was not performed between the environmental variables and species densities because the latter did not vary significantly across sites and sampling occasions.\n\n\nCommunity structure multiple regression models\n#BENTOS2006 - REGRESSÕES----\n#####....----\n\n#CORRELAÇÃO--------\n\ndev.off() #apaga os graficos, se houver algum\nrm(list=ls(all=TRUE)) #limpa a memória\ncat(\"\\014\") #limpa o console\n\nanovas <- read.csv(\"t_anovas.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\n\nggplot(anovas, aes(x = dens, y = Srare)) +\n  geom_point(size = 3, color = \"#00AFBB\") +\n  geom_smooth(method = \"lm\", color = \"#FC4E07\", se = TRUE) +\n  labs(\n    x = \"dens\",\n    y = \"Srare\",\n    title = \"Correlação entre dens e Srare\"\n  ) +\n  theme_minimal()\ncor.test(anovas$dens, anovas$Srare, method = \"pearson\")\n\n#STEPWISE REGRESSION----\n\n#browseURL(\"https://www.r-bloggers.com/2023/12/a-complete-guide-to-stepwise-regression-in-r/\")\n#browseURL(\"https://www.sthda.com/english/articles/37-model-selection-essentials-in-r/154-stepwise-regression-essentials-in-r/\")\n\nlibrary(tidyverse)\nlibrary(caret)\nlibrary(leaps)\nlibrary(MASS)\n\n##ORGANIZANDO OS DADOS----\n\nm_hab_part <- read.csv(\"m_hab_part.csv\",\n                       sep = \";\", dec = \".\",\n                       row.names = 1,\n                       header = TRUE,\n                       na.strings = NA)\n\n# Select only columns starting with \"m.\"\ncolnames(m_hab_part)\nvars <- grep(\"^(m)\\\\.\", colnames(m_hab_part), value = TRUE) #^(g|m) mais de uma inicial\nvars\nm_vars <- sqrt((m_hab_part[, vars])) #TRANSFORMAÇÃO\nm_vars\ndata <- cbind(Srare = anovas$Srare, m_vars)\ndata\n\n# Fit the full model\nfull.model <- lm(Srare ~., data = data)\n# Stepwise regression model\nstep.model <- stepAIC(full.model, direction = \"both\", #both, backward, forward\n                      trace = FALSE)\nsummary(step.model)\n\nmodels <- regsubsets(Srare ~., data = data, nvmax = 5, #maximal number of predictors to incorporate in the model\n                     method = \"seqrep\") #sequential replacement, combination of forward and backward selections\nsummary(models)\n\n# Train model\nset.seed(123)\n# set up repeated k-fold (number=10) cross-validation (\"cv\")\ntrain.control <- trainControl(method = \"cv\", number = 10)\n# Train the model\nstep.model <- train(Srare ~., data = data,\n                    method = \"leapBackward\",\n                    tuneGrid = data.frame(nvmax = 1:5),\n                    trControl = train.control)\n#**You can't directly use two different data frames in train(), because train()\n#(from caret package) expects all predictor (X) and response (Y) variables\n#to be in the same data frame.\nstep.model$results\nstep.model$bestTune\nsummary(step.model$finalModel)\nnvmax <- step.model$bestTune$nvmax\nnvmax\ncoef(step.model$finalModel, nvmax)\n\nlm_model <- lm(Srare ~  m.slope + m.width,\n   data = data)\nsummary(lm_model)\ncolnames(m_vars)\n\n###ALGUNS GRÁFICOS----\n\npar(mfrow = c(2,2))\nplot(step.model)\nvarImp(step.model)\n#library(car)\n#crPlots(step.model)\n#par(mfrow = c(1,1))\n\n\nOrdination analysis revealed a wide variation in community composition across sampling occasions with some degree of similarity within sites. The NMDS resulted in a non-metric fit (R2) of 0.97, with a stress of 0.173 (Figure 3).\n\n\nCommunity data Classification and Ordination analysis\n#BENTOS2006 - NMDS----\n#####....----\n\n##ORGANIZANDO DADOS----\n\ndev.off() #apaga os graficos, se houver algum\nrm(list=ls(all=TRUE)) #limpa a memória\ncat(\"\\014\") #limpa o console\n\nt_grps <- read.csv(\"t_grps.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_dens <- read.csv(\"m_dens.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_hab_part <- read.csv(\"m_hab_part.csv\",\n                       sep = \";\", dec = \".\",\n                       row.names = 1,\n                       header = TRUE,\n                       na.strings = NA)\nm_cont <- read.csv(\"m_cont.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\n\nm_dens\nstr(m_dens)\nm_trab <- m_dens\n\n#CLASSIFICAÇÃO: Matriz Comunitária----\n\nlibrary(vegan)\nm_trns <- asin(sqrt(decostand(m_trab,\n                              method=\"total\", MARGIN = 2)))\n#m_trns <- sqrt(m_trab)\n\n# Salvando a matriz transformada\nwrite.table(m_trns, \"m_com_trns.csv\",\n            sep = \";\", dec = \".\", #\"\\t\",\n            row.names = TRUE,\n            quote = TRUE,\n            append = FALSE)\n\nm_dist <- vegdist(m_trns, method = \"bray\",\n                   diag = TRUE,\n                   upper = FALSE)\nsave(m_dist, file = \"m_dist.RData\")\nload(\"m_dist.RData\")\n\ncluster_uas <- hclust(m_dist, method = \"average\")\npng(\"fig-cluster.png\", width = 9, height = 7, units = \"in\", res = 400)\nplot(cluster_uas, main = \"Cluster Dendrogram - Bray-Curtis da Matriz Comunitária\",\n      hang = 0.1) #testar com -.01\n#rect.hclust(cluster_uas, k = 3, h = NULL)\n#h = 0.8 fornece os grupos formados na altura h\ndev.off()\nas.matrix(m_dist)[1:6, 1:6]\n\n# Heatmap\nlibrary(\"gplots\")\nheatdist <- as.matrix(m_dist)\ncol <- rev(heat.colors(999)) #rev() reverte as cores do heatmap\npng(\"fig-heatmap_uas.png\", width = 9, height = 7, units = \"in\", res = 400)\nheatmap.2(x=(as.matrix(m_dist)), #objetos x objetos\n          Rowv = as.dendrogram(cluster_uas),\n          Colv = as.dendrogram(cluster_uas),\n          key = T, tracecol = NA, revC = T,\n          col = heat.colors,  #dissimilaridade = 1 - similaridade\n          density.info = \"none\",\n          xlab = \"UA´s\", ylab = \"UA´s\",\n          mar = c(6, 6) + 0.2)\ndev.off()\ncluster_spp <- hclust((m_dist(t(m_trns), method = \"bray\",\n                               diag = TRUE,\n                               upper = FALSE)), method = \"average\")\npng(\"fig-cluster_spp.png\", width = 9, height = 7, units = \"in\", res = 400)\nplot (cluster_spp, main = \"Dendrograma dos atributos\")\ndev.off()\npng(\"fig-heatmap.png\", width = 9, height = 9, units = \"in\", res = 400)\nheatmap.2(t(as.matrix(m_trns)), #objetos x atributos\n          Colv = as.dendrogram(cluster_uas),\n          Rowv = as.dendrogram(cluster_spp),\n          key = T, tracecol = NA, revC = T,\n          col = col,\n          density.info = \"none\",\n          xlab = \"Unidades amostrais\", ylab = \"Espécies\",\n          mar = c(6, 6) + 1.8)  # adjust margin size\ndev.off()\n\n# Histórico das fusões\nlibrary(tidyverse)\nlibrary(gt)\nmerge <- as.data.frame(cluster_uas$merge)\nmerge[nrow(merge)+1,] = c(\"0\",\"0\")\nheight <- as.data.frame(round(cluster_uas$height, 2))\nheight[nrow(height)+1,] = c(\"1.0\")\nfusoes <- data.frame(Cluster_uas = merge, Height = height)\ncolnames(fusoes) <- c(\"Cluster1\", \"Cluster2\", \"Height\")\nUA <- rownames_to_column(as.data.frame(m_trns[, 0]))\ncolnames(UA) <- c(\"UAs\")\nNo.UA <- 1:nrow(fusoes)\nfusoes <- cbind(No.UA, UA, fusoes)\nfusoes$Histórico <- 1:nrow(fusoes)\n#fusoes\nfusoes <- gt(fusoes)\nfusoes\ngtsave(fusoes, \"Fusoes.html\")\n\n#ORDENAÇÃO----\n\nnmds <- metaMDS(m_trns, #matriz CPE, definida anteriormente\n                k=2) #no. de redução de dimensões\nnmds\nset.seed(321)\nnmds <- metaMDS(m_trns, distance = \"bray\", k = 2, trymax = 100)\n#method = \"manhattan\", \"euclidean\", \"canberra\", \"clark\", \"bray\", \"kulczynski\", \"jaccard\", \"gower\", #\"altGower\", \"morisita\", \"horn\", \"mountford\", \"raup\", \"binomial\", \"chao\", \"cao\", \"mahalanobis\", \"chisq\", #\"chord\", \"hellinger\", \"aitchison\", or \"robust.aitchison\"\nnmds\nscores(nmds)\nstressplot(nmds)\ngof <- goodness(nmds)\ngof\n\n##GRAFICOS DE ORDENAÇÃO----\n\nplot(nmds, display = \"sites\", type = \"n\")\npoints(nmds, display = \"sites\", cex = 2*gof/mean(gof))\nplot(nmds)\nordiplot(nmds, choices = c(1,2), type = \"n\")\norditorp(nmds, display = \"species\", col=\"red\", air=0.01)\norditorp(nmds, display = \"sites\", cex=1.25, air=0.01)\n\nplot(nmds)\ncolnames(t_grps)\ngrupos <- t_grps$UA\ngrupos\n\n###GRÁFICO FINAL----\ncolors <- dplyr::recode(grupos, #conflito com outro pacote(?)\n                 \"CI\" = \"grey\",\n                 \"SA\" = \"black\",\n                 \"MU\" = \"black\",\n                 \"EP\" = \"grey\",\n                 \"RE\" = \"black\",\n                 \"SE\" = \"grey\",\n                 .default = \"black\")\ncolors\npng(\"fig-NMDS.png\", width = 9, height = 7, units = \"in\", res = 400)\nordiplot(nmds, type = \"n\")\nordihull(nmds, groups = grupos, draw = \"polygon\",\n         col= \"grey90\", label = TRUE)\n#orditorp(nmds, display = \"species\", col = \"red\", air = 0.01)\n#orditorp(nmds, display = \"sites\", col = colors, air = 0.01, cex = 1.25)\n#points(nmds, display = \"sites\", pch = 21, col = \"black\", bg = colors, cex = 1.25)\n\n#sites_coords <- scores(nmds, display = \"sites\")\nsites_coords <- read.table(\"nms_sites_coords.txt\")\n#text(sites_coords[,1], sites_coords[,2],\n#     labels = rownames(sites_coords),\n#     col = colors, cex = 1, pos = 3)  # pos = 3 puts labels above\n#fix(sites_coords)\n#write.table(sites_coords, \"nms_sites_coords.txt\")\ndev.off()\n\n# Mais gráficos----\npar(mfrow=c(2,2))\nordiplot(nmds, type = \"n\")\norditorp(nmds, display = \"species\", col = \"red\", air = 0.01)\norditorp(nmds, display = \"sites\", col = colors, air = 0.01, cex = 1.25)\nordihull(nmds, groups = grupos, draw = \"polygon\", col = \"grey90\", label = TRUE)\n\nordiplot(nmds, type = \"n\")\norditorp(nmds, display = \"species\", col = \"red\", air = 0.01)\norditorp(nmds, display = \"sites\", col = colors, air = 0.01, cex = 1.25)\nordiellipse(nmds, groups = grupos, display = \"sites\", draw = \"polygon\", col = \"grey90\", label = T)\nordibar(nmds, grupos, display = \"sites\")\n\nordiplot(nmds, type = \"n\")\norditorp(nmds, display = \"species\", col = \"red\", air = 0.01)\norditorp(nmds, display = \"sites\", col = colors, air = 0.01, cex = 1.25)\nordispider(nmds, grupos, display=\"sites\")\n\nordiplot(nmds, type = \"n\")\norditorp(nmds, display = \"species\", col = \"red\", air = 0.01)\norditorp(nmds, display = \"sites\", col = colors, air = 0.01, cex = 1.25)\nordicluster(nmds, cluster_uas, prune = 0, display = \"sites\")\npar(mfrow=c(1,1))\n\nplot(nmds)\nordiplot(nmds, type = \"n\")\norditorp(nmds, display = \"species\", col = \"red\", air = 0.01)\norditorp(nmds, display = \"sites\", col = colors, air = 0.01, cex = 1.25)\nordicluster(nmds, hclust(m_dist(m_trns, \"bray\")))\n#?ordicluster\n\nplot(nmds)\nordiplot(nmds, type = \"n\")\n# Plot convex hulls with colors baesd on treatment\nfor(i in unique(grupos)) {\n  ordihull(nmds$point[grep(i,grupos),],draw=\"polygon\",groups=grupos[grupos==i],col=colors[grep(i,grupos)],label=F) }\norditorp(nmds, display = \"species\", col= \"red\", air = 0.01)\norditorp(nmds, display = \"sites\", col = colors, air = 0.01, cex = 1.25)\n\nm <- nrow(m_trns)\nsurf1 <- seq(1, m)\nsurf2 <- c(cluster_uas$height, 1)\nsurf3 <- m_hab_part$m.width\nknots <- nrow(m_trns)\n\nplot(nmds)\nordisurf(nmds, surf1, main = \"\", col = \"forestgreen\", knots = knots)\nordisurf(nmds, surf2, main = \"\", add = TRUE, col = \"green\", knots = knots)\norditorp(nmds, display = \"sites\", col = \"grey30\", air = 0.1, cex = 1)\norditorp(nmds, display = \"species\", col = \"grey30\", air = 0.1, cex = 1)\nlegend ('topleft', col = c('forestgreen', 'green'), lty = 1, legend = c('surf1', 'surf2'))\n\n\nSpatial segregation in macroinvertebrate composition was confirmed by MRPP, which shows significant differences between sites (A = 0.14, p = 0.001), but not for sampling months (A=-0.01, p=0.815) or seasons (wet/dry) (A < 0.01, p = 0.413). Differences between reservoir and stream sites were also significant (A = 0.03, p = 0.004).\n\n\nPaired multiple comparison analyses\n#BENTOS2006 - MRPP----\n#####....----\n\n##ORGANIZANDO DADOS----\n\ndev.off() #apaga os graficos, se houver algum\nrm(list=ls(all=TRUE)) #limpa a memória\ncat(\"\\014\") #limpa o console\n\nt_grps <- read.csv(\"t_grps.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_dens <- read.csv(\"m_dens.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_hab_part <- read.csv(\"m_hab_part.csv\",\n                       sep = \";\", dec = \".\",\n                       row.names = 1,\n                       header = TRUE,\n                       na.strings = NA)\nm_cont <- read.csv(\"m_cont.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\n\nm_trab <- m_dens\n\nlibrary(vegan)\nm_trns <- asin(sqrt(decostand(m_trab,\n                              method=\"total\", MARGIN = 2))) #see hellinger\n#m_trns <- sqrt(m_trab)\n\nm_trab <- (m_trns)\nt_grps\n\n#TRABALHANDO COM MULTIPLAS VARIAVEIS----\n\n# Run MRPP for multiple variables\nfatores <- c(\"UA\", \"mes\", \"estacao\", \"area\", \"ambiente\")\nset.seed(123)\nmrpp_results <- lapply(fatores, function(v) {\n  grp <- as.factor(t_grps[[v]])\n  mrpp(\n    dat = m_trab,\n    grouping = grp,\n    distance = \"bray\"\n  )\n})\nnames(mrpp_results) <- fatores\nmrpp_results\n# Print one result\nmrpp_results$UA\n# Loop through summaries\nsink(file = \"mrpp.txt\", split = TRUE)#, append = TRUE)\nfor (v in names(mrpp_results)) {\n  cat(\"\\n============================\\n\")\n  cat(\"MRPP for:\", v, \"\\n\")\n  print(mrpp_results[[v]])\n}\nsink()\n# Extract key statistics into a table\nmrpp_summary <- data.frame(\n  Variable = fatores,\n  Delta = sapply(mrpp_results, function(x) x$delta),\n  Expected_Delta = sapply(mrpp_results, function(x) x$E.delta),\n  A = sapply(mrpp_results, function(x) x$A),\n  P_value = sapply(mrpp_results, function(x) x$Pvalue)\n)\nsink(\"mrpp.txt\", append = TRUE)\nmrpp_summary\nsink()\n\n##TRABALHANDO COM UMA UNICA VARIAVEL----\n\n# Run MRPP for a single variable\ngrp <- as.factor(t_grps$UA) #UA, mes, estacao, area, ambiente\nset.seed(123)\nmrpp <- mrpp(dat = m_trab, grouping = grp, distance = \"bray\")\nmrpp\nsummary(mrpp)\n\n# Teste de hipótese para uma unica variavel\nstr(mrpp)\np_value <- mrpp$Pvalue\nprint(sprintf(\"p-value: %.10f\", p_value))\n# Conditional statement to check the p-value and print the appropriate message\nif (p_value < 0.05) {\n  print(sprintf(\"Existe diferença significativa porquê o valor de p é %.10f, sendo menor que o nível de significância de 0.05.\", p_value))\n} else {\n  print(sprintf(\"Não existe diferença significativa porquê o valor de p é %.10f, sendo maior ou igual ao nível de significância de 0.05.\", p_value))\n}\n\n##TESTES PAREADOS----\n\nlibrary(vegan)\n# Todos os pares de níveis do fator\npairs <- combn(levels(as.factor(grp)), 2, simplify = FALSE)\npairs\n# Aplicar mrpp para cada par\nres_list <- lapply(pairs, function(p) {\n  sel <- grp %in% p\n  mrpp(dat = m_trab[sel, ], grouping = droplevels(grp[sel]), distance = \"bray\")\n})\n# Dar nomes aos resultados\nnames(res_list) <- sapply(pairs, function(p) paste(p, collapse = \"_vs_\"))\n# visualizar\nres_list\n# Resumo\nsummary_tab <- data.frame(\n  Comparison = names(res_list),\n  A = sapply(res_list, function(x) x$A),\n  Delta = sapply(res_list, function(x) x$delta),\n  Pvalue = sapply(res_list, function(x) x$Pvalue)\n)\nsummary_tab\n\n###MATRIX-STYLE TABLE----\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(knitr)\nlibrary(kableExtra)\n# Extract unique group names from the comparisons\ngroups1 <- sort(unique(unlist(strsplit(summary_tab$Comparison, \"_vs_\"))))\n# Initialize empty matrix\npval_matrix <- matrix(NA, nrow = length(groups1), ncol = length(groups1),\n                      dimnames = list(groups1, groups1))\n# Fill matrix with Pvalues\nfor (i in 1:nrow(summary_tab)) {\n  comp <- unlist(strsplit(summary_tab$Comparison[i], \"_vs_\"))\n  g1 <- comp[1]\n  g2 <- comp[2]\n  p <- summary_tab$Pvalue[i]\n\n  pval_matrix[g1, g2] <- p\n  pval_matrix[g2, g1] <- p  #make symmetric\n}\n\n# Format p-values: red if <0.05\npval_colored <- ifelse(is.na(pval_matrix), \"\",\n                       ifelse(pval_matrix < 0.05,\n                              paste0(\"<span style='color:red;'>\", sprintf(\"%.3f\", pval_matrix), \"</span>\"),\n                              sprintf(\"%.3f\", pval_matrix)))\n\n# Convert to data.frame for kable\npval_df <- as.data.frame(pval_colored)\npval_df <- tibble::rownames_to_column(pval_df, \"Group\")\n# Render HTML table\nmatrixstyle <- pval_df %>%\n  kable(\"html\", escape = FALSE) %>%\n  kable_styling(full_width = FALSE)\nmatrixstyle\nsave_kable(matrixstyle, \"kb-mrpp_matrixstyle.html\")\n\n##GRÁFICO DA MRPP----\n\npng(\"fig-mrpp.png\", width = 15, height = 10, units = \"in\", res = 300)\ndef.par <- par(no.readonly = TRUE)\nlayout(matrix(1:2,nr=1))\nplot(ord <- metaMDS(m_trab, distance=\"bray\"), type=\"text\", display=\"sites\")\nwith(t_grps, ordihull(ord, grp))\nwith(mrpp, {\n  fig.dist <- hist(boot.deltas, xlim=range(c(delta,boot.deltas)),\n                   main=\"Test of Differences Among Groups\")\n  abline(v=delta);\n  text(delta, 2*mean(fig.dist$counts), adj = -0.5,\n       expression(bold(delta)), cex=1.5 )  }\n)\npar(def.par)\ndev.off()\n\n###AVALIANDO AS DISTÂNCIAS MÉDIAS----\nmd <- with(t_grps, meandist(vegdist(m_trab), grp))\nmd\nsummary(md)\npar(mfrow=c(1,2))\nplot(md)\nplot(md, kind=\"histogram\")\npar(mfrow=c(1,1))\n\n#PerMANOVA----\n\n#browseURL(\"https://riffomonas.org/code_club/2021-03-18-vegan\")\n#browseURL(\"https://riffomonas.org/code_club/2021-03-22-reproducibility\")\n\nlibrary(tidyverse)\nlibrary(ggtext)\nlibrary(ggplot2)\nlibrary(vegan)\n\nadonis2(m_trab ~ UA, data = t_grps, method = \"bray\")\nset.seed(123)\nperm <- 999\n\nall_test <- adonis2(m_trab ~ UA, data = t_grps, method = \"bray\", permutations = perm)\nall_test\n\nadonis2(m_trab ~ area*ambiente, data = t_grps)\nadonis2(m_trab ~ area*ambiente, data = t_grps, by = \"terms\") #ou by=NULL remove as interações\n\nall_p <- all_test$`Pr(>F)`[1]\nall_p\n\ncount(t_grps, UA)\ncolnames(t_grps)\n\n# Pairwise comparisons\n#browseURL(\"https://doi.org/10.1007/s10641-018-0751-1\")\n#Lanés, L.E.K., Reichard, M., de Moura, R.G. et al. 2018.\n#Environmental predictors for annual fish assemblages in subtropical\n#grasslands of South America: the role of landscape and habitat\n#characteristics. Environ Biol Fish 101, 963–977.\n\nlibrary(dplyr)\n#library(combninat) # or base R combn()\n\nset.seed(123)\n\n# Get unique levels of UA\ngroups <- unique(t_grps$UA)\ngroups\n# All pairwise combinations\npairs <- combn(groups, 2, simplify = FALSE)\npairs\n# Store results\npairwise_results <- lapply(pairs, function(g) {\n  # Subset data\n  sub_data <- t_grps %>% filter(UA %in% g)\n  sub_dist <- m_trab[rownames(sub_data), ]\n\n  # Run adonis2\n  test <- adonis2(sub_dist ~ UA, data = sub_data,\n                  method = \"bray\", permutations = perm)\n\n  tibble(\n    group1 = g[1],\n    group2 = g[2],\n    F_value = test$F[1],\n    R2 = test$R2[1],\n    p_value = test$`Pr(>F)`[1]\n  )\n})\n# Bind all results\npairwise_results <- bind_rows(pairwise_results)\npairwise_results\npairwise_p <- numeric()\npairwise_p <- pairwise_results$p_value\npairwise_p\nadj_p_values <- p.adjust(pairwise_p, method=\"bonferroni\") #c(\"holm\", \"hochberg\", \"hommel\", \"bonferroni\", \"BH\", \"BY\", \"fdr\", \"none\")\nadj_p_values\npairwise_results$adj_p_values <- adj_p_values\npairwise_results\n# Get unique group names\ngroups2 <- sort(unique(c(pairwise_results$group1, pairwise_results$group2)))\n# Initialize empty matrix\npval_matrix <- matrix(NA, nrow = length(groups2), ncol = length(groups2),\n                      dimnames = list(groups2, groups2))\n# Fill in p-values\nfor (i in 1:nrow(pairwise_results)) {\n  g1 <- pairwise_results$group1[i]\n  g2 <- pairwise_results$group2[i]\n  p <- pairwise_results$p_value[i]\n\n  pval_matrix[g1, g2] <- p\n  pval_matrix[g2, g1] <- p  #make symmetric\n}\npval_matrix\n\nlibrary(knitr)\nlibrary(kableExtra)\n\n# Make a copy of the matrix\npval_colored <- pval_matrix\n# Replace numeric values with formatted HTML strings\npval_colored[] <- ifelse(is.na(pval_matrix), \"\",\n                         ifelse(pval_matrix < 0.05,\n                                paste0(\"<span style='color:red;'>\", sprintf(\"%.3f\", pval_matrix), \"</span>\"),\n                                sprintf(\"%.3f\", pval_matrix)))\n# Convert to data frame with rownames\npval_df <- as.data.frame(pval_colored)\npval_df <- tibble::rownames_to_column(pval_df, \"Group\")\n# Render table\npval_df %>%\n  kable(\"html\", escape = FALSE) %>%\n  kable_styling(full_width = FALSE)\nsave_kable(matrixstyle, \"kb-perma_matrixstyle.html\")\n\n## AVALIANDO INTERAÇÕES-----\n\nadonis2(m_trab ~ area, data = t_grps, method = \"bray\")\nadonis2(m_trab ~ area*ambiente, data = t_grps,\n        method = \"bray\") #+ no lugar de * tira os residuos\nadonis2(m_trab ~ area*ambiente, data = t_grps,\n        method = \"bray\", by = \"terms\", strata = NULL)\n\nload(\"m_dist.RData\")\n\nbd <- betadisper(m_dist, t_grps$are)\nbd\nanova(bd)\npermutest(bd)\n\nbd <- betadisper(m_dist, t_grps$env)\nbd\nanova(bd)\npermutest(bd)\n\nbd <- betadisper(m_dist, t_grps$UA)\nbd\nanova(bd)\npermutest(bd, pairwise = TRUE)\n\nlibrary(betapart)\nbd.HSD <- TukeyHSD(bd)\nplot(bd.HSD)\nplot(bd)\nbdist <- bd$distances\nbdist\n\nplot(bd, ellipse = TRUE, hull = FALSE) # 1 sd data ellipse\nplot(bd, ellipse = TRUE, hull = FALSE, conf = 0.90) # 90% data ellipse\nboxplot(bd)\n\n\nIndicator Species Analysis identified ten taxa with significant indicator values (p < 0.05), partially overlapping with the multilevel pattern results. Several taxa were confirmed as indicators of RE, these being Oligochaeta, Conchostraca, Physidae and Coenagrionidae, all showing high indicator values (IndVal = 0.82–0.98, p < 0.03). Corixidae remained the solely indicator of CI (IndVal = 0.86, p = 0.013). Further exploration using Multilevel Pattern Analysis incorporated additional as indicators of specific site combinations, which were Ceratopogonidae and Libellulidae, for CI and RE (IndVal = 0.87-0.94, p < 0.007), Thiaridae and Atyidae, both associated with EP and SE (IndVal = 0.76-0.99, p < 0.048) and Planorbidae, associated with CI, RE, and SE (IndVal = 0.91, p = 0.048) (Figure 8).\n\n\nIndicator species analises\n#BENTOS2006 - ISA----\n#####....----\n\n##ORGANIZANDO DADOS----\n\ndev.off() #apaga os graficos, se houver algum\nrm(list=ls(all=TRUE)) #limpa a memória\ncat(\"\\014\") #limpa o console\n\nt_grps <- read.csv(\"t_grps.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_dens <- read.csv(\"m_dens.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\n\nm_trab <- m_dens\nt_grps\nload(\"m_dist.Rdata\")\n\n#ISA----\n#browseURL(\"https://cran.r-project.org/web/packages/indicspecies/vignettes/IndicatorSpeciesAnalysis.html\")\n\n\nlibrary(indicspecies)\n# Grupos a priori----\ngrupos <- t_grps$UA\ngrupos\n#OU\nrep <- c(rep(\"Serido\", 12), rep(\"Buique\", 11))\nrep\n#OU\nlevs <- factor(c(rep(1,12), rep(2,11)), labels = c(\"Serido\",\"Buique\"))\nlevs\n#OU Grupos a posteriori\nkm <- kmeans(m_trab, centers=3)\ngruposkm <- km$cluster\ngruposkm\n\n##VALORES INDICATIVOS (IV)----\n\n# Multi-level Pattern Analysis\nset.seed(123)\nindval <- multipatt(m_trab, grupos,\n                    control = how(nperm=999))\nindval\n\nsink(\"isa_indval.txt\", split=TRUE)\n# Summary of the results\nsummary(indval)\n# Examining the indicator value components\nsummary(indval, indvalcomp=TRUE)\n# Inspecting the indicator species analysis results for all species\nsummary(indval, alpha=1)\n\n###RESUMO GERAL----\nindval$sign\nsubset(indval$sign, p.value <= 0.05) #only p<0.05 species\nsink()\n\n# Tabela ordenada pelo menor valor de P\nindval$sign[order(indval$sign$p.value), ]\nlibrary(\"gt\")\nlibrary(\"webshot2\")\nindicator_val <- gt(indval$sign[order(indval$sign$p.value), ], rownames_to_stub=TRUE)\nindicator_val\ngtsave(indicator_val, \"gt-indval_gttable.html\")\ngtsave(indicator_val, \"fig-indval_gttable.png\")\n\n##SPECIES ECOLOGICAL PREFERENCES (phi)----\nset.seed(123)\npa <- ifelse(m_trab>0,1,0)\nphi <- multipatt(pa, grupos, func = \"r\", \n                 control = how(nperm=999))\nphi\nphi <- multipatt(pa, grupos, func = \"r.g\", \n                 control = how(nperm=999)) \nsummary(phi)\nround(head(phi$str),3)\nround(head(indval$str),3)\n# Subsetting for p<0.05\nsig_phi <- rownames(subset(phi$sign, p.value <= 0.05))\nround(phi$str[sig_phi, , drop = FALSE], 3)\nsig_indval <- rownames(subset(indval$sign, p.value <= 0.05))\nround(indval$str[sig_indval, , drop = FALSE], 3)\n\n# Tabela ordenada pelo menor valor de P\nphi$sign[order(phi$sign$p.value), ]\nlibrary(\"gt\")\nlibrary(\"webshot2\")\nphi_val <- gt(phi$sign[order(phi$sign$p.value), ], rownames_to_stub=TRUE)\nphi_val\ngtsave(phi_val, \"gt-phi_gttable.html\")\ngtsave(phi_val, \"fig-phi_gttable.png\")\n\n###SPECIES OF INTEREST p<0.05----\nsig <- subset(phi$sign, p.value <= 0.05) #only p<0.05 species\nsink(\"isa_indval.txt\", append=TRUE)\nsig\nsink()\n\nlibrary(ggplot2)\nsig$species <- rownames(sig)\nggplot(sig, aes(x = reorder(species, stat), y = stat)) +\n  geom_col() +\n  coord_flip() +\n  labs(\n    x = \"Species\",\n    y = \"Indicator value (r.g)\",\n    title = \"Significant species–habitat associations\"\n  )\nassoc <- sig[, grep(\"^s\\\\.\", names(sig))]\nassoc$species <- rownames(sig)\nassoc_long <- reshape2::melt(assoc, id.vars = \"species\")\npng(\"fig-sig_spp.png\")\nggplot(assoc_long, aes(variable, species, fill = value)) +\n  geom_tile() +\n  scale_fill_gradient(low = \"white\", high = \"black\") +\n  labs(x = \"Group\", y = \"Species\")\ndev.off()\n\n#R base\nbarplot(\n  sig$stat,\n  names.arg = rownames(sig),\n  horiz = TRUE,\n  las = 1,\n  xlab = \"Indicator value (r.g)\")\n\n\nRedundancy analysis (Figure 4) revealed a significant relationship between macroinvertebrate community composition and the site morphology variables, river length, maximum site depth, and site width (Permutation test, F~3,18 = 4.71, p = 0.001). The constrained model explained 43.99% of the total community variation (adjusted R2 = 0.35), with the remaining 56.01% attributable to unconstrained variation. The first RDA axis was highly significant (F~1,18 = 11.33, p = 0.001) and accounted for 80.2% of the constrained inertia, whereas the second and third axes were not significant (p > 0.20). Sequential permutation tests indicated that channel width (F = 8.59, p = 0.001) and river length (F = 3.70, p = 0.013) contributed significantly to explaining community structure, while maximum depth had a weaker, non-significant effect (p = 0.10). Marginal tests confirmed that width and river length remained significant predictors when evaluated independently (p = 0.001). Species scores along RDA1 indicated strong associations of Oligochaeta and larvae of Chironomidae (≈ 40%) with wider sites (indicative of artificial reservoirs), whereas Thiaridae showed a pronounced negative association with RDA1 (90%), corresponding to narrower and shorter river reaches.\nAmong the water quality variables, the model including only turbidity showed significant relationship with macroinvertebrate community composition (F1,20 = 3.37, p = 0.013). The constrained model explained 14.42% of the total variation in community composition (adjusted R2 = 0.10). The first RDA axis was significant (F1,20 = 3.37, p = 0.01) and accounted for 100% of the constrained inertia, reflecting the presence of a single explanatory variable. Both sequential and marginal permutation tests confirmed that turbidity independently explained a significant proportion of variation in community structure (p = 0.015 and p = 0.008, respectively). Species scores along RDA1 showed strong positive associations of Thiaridae (56%) with higher turbidity values, whereas Oligochaeta (37%) and Notonectidae (18%) were negatively associated with this axis.\nSubstrate composition revealed a weak overall relationship between macroinvertebrate community composition and the sediment variables. The final reduced model included only mud and sand (permutation test, F2,19 = 1.70, p = 0.089). The constrained model explained 15.21% of the total community variation (adjusted R2 = 0.06). The first RDA axis was marginally significant (F1,19 = 2.70, p = 0.097) and accounted for 79.2% of the constrained inertia, whereas the second axis was not significant (p = 0.60). Sequential permutation tests indicated that sand contributed significantly to explaining community structure (F = 2.69, p = 0.035), while mud did not show a significant sequential effect (p = 0.59). Nonetheless, marginal tests showed that both sand (F = 2.69, p = 0.038) and mud (F = 2.44, p = 0.043) independently explained significant portions of community variation when evaluated while controlling for the other variable. Species scores along first RDA axis indicated a positive association of Chironomidae larvae (50%) and Notonectidae(13%) with sandy substrates, whereas Thiaridae (29%) and Oligochaeta (16%) showed strong negative associations with this axis, corresponding to sites with higher mud content.\nRelationship between macroinvertebrate community composition and habitat structure variables was significant, with the final reduced model including macrophytes, submerged vegetation, litter, roots, and algae (F5,16 = 2.89, p = 0.001). The constrained model explained 47.43% of the total variation (adjusted R2 = 0.31). The first two RDA axes were significant, with RDA1 (F1,16 = 8.03, p = 0.003) and RDA2 (F1,16 = 4.00, p = 0.041), together accounting for 83.3% of the constrained inertia. The sequential permutation tests indicated that macrophyte cover (F = 4.34, p = 0.003), leaf litter (F = 2.61, p = 0.038), roots (F = 2.58, p = 0.024), and algae (F = 3.12, p = 0.014) contributed significantly to explaining community structure. Marginal tests confirmed that macrophytes (p = 0.002), roots (p = 0.003), and algae (p = 0.019) remained significant predictors when evaluated independently, while submerged vegetation and leaf litter showed weaker, non-significant marginal effects (p > 0.06). Species scores along RDA1 indicated strong positive associations of larvae of Chironomidae (36%) and Oligochaeta (35%) with sites characterized by higher macrophyte and leaf litter cover, whereas Thiaridae showed a pronounced negative association with this axis (79%), corresponding to habitats with lower structural complexity. Along RDA2, larvae of Chironomidae was positively associated (49%) with increased root and algal presence, whereas Oligochaeta was negatively associated, reflecting an important association with aquatic macrophytes.\n\n\nRedundancy Analysis\n#BENTOS2006 - RDA----\n#####....----\nbrowseURL(\"https://r.qcbs.ca/workshops/\")\n\n##ORGANIZANDO DADOS----\n\ndev.off() #apaga os graficos, se houver algum\nrm(list=ls(all=TRUE)) #limpa a memória\ncat(\"\\014\") #limpa o console\n\nt_grps <- read.csv(\"t_grps.csv\",\n                   sep = \";\", dec = \".\",\n                   row.names = 1,\n                   header = TRUE,\n                   na.strings = NA)\nm_dens <- read.csv(\"m_dens.csv\",\n                       sep = \";\", dec = \".\",\n                       row.names = 1,\n                       header = TRUE,\n                       na.strings = NA)\n\nlibrary(vegan)\nlibrary(tidyverse)\n\nm_m <- read.table(\"m_m.txt\")\nm_q <- read.table(\"m_q.txt\")\nm_s <- read.table(\"m_s.txt\")\nm_h <- read.table(\"m_h.txt\")\n\n##CLASSIFICAÇÃO 1: MATRIZ COMUNITÁRIA----\n\n###DENDROGRAMA E HEATMAP 1----\n\n# Dendrograma\n\ncluster_uas <- hclust(m_dist, method = \"average\")\nplot(cluster_uas, main = \"Cluster Dendrogram - Bray-Curtis da Matriz Comunitária\",\n      hang = 0.1) #testar com -.01\nrect.hclust(cluster_uas, k = 3, h = NULL) #h = 0.8 fornece os grupos formados na altura h\nas.matrix(m_dist)[1:6, 1:6]\n\n# Heatmap\nlibrary(\"gplots\")\nheatdist <- as.matrix(m_dist)\ncol <- rev(heat.colors(999)) #rev() reverte as cores do heatmap\nheatmap.2(x=(as.matrix(m_dist)), #objetos x objetos\n          Rowv = as.dendrogram(cluster_uas),\n          Colv = as.dendrogram(cluster_uas),\n          key = T, tracecol = NA, revC = T,\n          col = heat.colors,  #dissimilaridade = 1 - similaridade\n          density.info = \"none\",\n          xlab = \"UA´s\", ylab = \"UA´s\",\n          main = \"Comunidade\",\n          mar = c(6, 6) + 0.2)\ncluster_spp <- hclust((vegdist(t(m_trns), method = \"bray\",\n                            diag = TRUE,\n                            upper = FALSE)), method = \"average\")\nplot(cluster_spp, main = \"Dendrograma dos atributos\")\nheatmap.2(t(as.matrix(m_trns)), #objetos x atributos\n          Colv = as.dendrogram(cluster_uas),\n          Rowv = as.dendrogram(cluster_spp),\n          key = T, tracecol = NA, revC = T,\n          col = col,\n          density.info = \"none\",\n          xlab = \"Unidades amostrais\", ylab = \"Espécies\",\n          mar = c(6, 6) + 0.1)  #adjust margin size\n\n# Histórico das fusões\nlibrary(gt)\nmerge <- as.data.frame(cluster_uas$merge)\nmerge[nrow(merge)+1,] = c(\"0\",\"0\")\nheight <- as.data.frame(round(cluster_uas$height, 2))\nheight[nrow(height)+1,] = c(\"1.0\")\nfusoes <- data.frame(Cluster_uas = merge, Height = height)\ncolnames(fusoes) <- c(\"Cluster1\", \"Cluster2\", \"Height\")\nUA <- rownames_to_column(as.data.frame(m_trns[, 0]))\ncolnames(UA) <- c(\"UAs\")\nNo.UA <- 1:nrow(fusoes)\nfusoes <- cbind(No.UA, UA, fusoes)\nfusoes$Histórico <- 1:nrow(fusoes)\n#fusoes\ngt(fusoes)\n\n##CLASSIFICAÇÃO 2: MATRIZ AMBIENTAL----\n\n###DENDROGRAMA E HEATMAP 2----\n\n# Dendrograma\nm_hab_trns <- read.csv(\"m_hab_trns.csv\",\n                       sep = \";\", dec = \".\",\n                       row.names = 1,\n                       header = TRUE,\n                       na.strings = NA)\n\nm_dist_hab <- vegdist(m_hab_trns, method = \"bray\",\n                   diag = TRUE,\n                   upper = FALSE)\ncluster_uas <- hclust(m_dist_hab, method = \"average\")\nplot(cluster_uas, main = \"Cluster Dendrogram - Bray-Curtis para a Matriz Ambiental\",\n      hang = 0.1) #testar com -.01\nrect.hclust(cluster_uas, k = 3, h = NULL) \n#h = 0.8 fornece os grupos formados na altura h\nas.matrix(m_dist_hab)[1:6, 1:6]\n\n# Heatmap\nlibrary(\"gplots\")\nheatdist <- as.matrix(m_dist_hab)\ncol <- rev(heat.colors(999)) #rev() reverte as cores do heatmap\nheatmap.2(x=(as.matrix(m_dist_hab)), #objetos x objetos\n          Rowv = as.dendrogram(cluster_uas),\n          Colv = as.dendrogram(cluster_uas),\n          key = T, tracecol = NA, revC = T,\n          col = heat.colors,  #dissimilaridade = 1 - similaridade\n          density.info = \"none\",\n          xlab = \"UA´s\", ylab = \"UA´s\",\n          main = \"Dados ambientais\",\n          mar = c(6, 6) + 0.2)\ncluster_spp <- hclust((vegdist(t(m_hab_trns), method = \"bray\",\n                            diag = TRUE,\n                            upper = FALSE)), method = \"average\")\nplot(cluster_spp, main = \"Dendrograma dos atributos\")\nheatmap.2(t(as.matrix(m_hab_trns)), #objetos x atributos\n          Colv = as.dendrogram(cluster_uas),\n          Rowv = as.dendrogram(cluster_spp),\n          key = T, tracecol = NA, revC = T,\n          col = col,\n          density.info = \"none\",\n          xlab = \"Unidades amostrais\", ylab = \"Espécies\", main = \"Dados ambientais\",\n          mar = c(6, 6) + 0.1) #adjust margin size\n\n# Histórico das fusões\nlibrary(gt)\nmerge <- as.data.frame(cluster_uas$merge)\nmerge[nrow(merge)+1,] = c(\"0\",\"0\")\nheight <- as.data.frame(round(cluster_uas$height, 2))\nheight[nrow(height)+1,] = c(\"1.0\")\nfusoes <- data.frame(Cluster_uas = merge, Height = height)\ncolnames(fusoes) <- c(\"Cluster1\", \"Cluster2\", \"Height\")\nUA <- rownames_to_column(as.data.frame(m_hab_trns[, 0]))\ncolnames(UA) <- c(\"UAs\")\nNo.UA <- 1:nrow(fusoes)\nfusoes <- cbind(No.UA, UA, fusoes)\nfusoes$Histórico <- 1:nrow(fusoes)\n#fusoes\ngt(fusoes)\n\n##CLASSIFICAÇÃO 3: Heatmap Matriz comunitária *vs.* Matriz ambiental----\n\n###DENDROGRAMA E HEATMAP 3----\n\n# Dendrograma\nlibrary(vegan)\nlibrary(gplots)\n# Dendrograma para as UA's da matriz comunitária\ncluster_uas_com <- hclust(m_dist, method = \"average\")\nplot(cluster_uas_com, main = \"Cluster Dendrogram - Bray-Curtis da Matriz Comunitária\",\n      hang = 0.1) #testar com -.01\nrect.hclust(cluster_uas_com, k = 3, h = NULL) \n#h = 0.8 fornece os grupos formados na altura h\nas.matrix(m_dist)[1:6, 1:6]\n\n# Dendrograma para as variáveis particionadas da matriz ambiental\nm_trns_hab <- sqrt(m_hab_part)\ncluster_mpart_hab <- hclust((vegdist(t(m_trns_hab),\n                            method = \"bray\",\n                            diag = TRUE,\n                            upper = FALSE)), method = \"average\")\nplot(cluster_mpart_hab, main = \"Dendrograma dos atributos\")\n\n# Heatmap Comunidade vs. Morfologia\nheatmap.2(t(as.matrix(m_trns_hab)), #objetos x atributos\n          Colv = as.dendrogram(cluster_uas_com),\n          Rowv = as.dendrogram(cluster_mpart_hab),\n          key = T, tracecol = NA, revC = T,\n          col = col,\n          density.info = \"none\",\n          xlab = \"Unidades amostrais\", ylab = \"Varíáveis ambientais\",\n          mar = c(6, 9) + 0.1)  #adjust margin size\n\n# Explorando correlações multivariadas da matriz de habitat\n#plot(m_trns_a$\"m.elev\", m_trns_a$\"m.river\")\n#plot(scale(m_trns_a$\"m.elev\"), scale(m_trns_a$\"m.river\"))\n#plot((m_trns_a$\"m.elev\" - mean(m_trns_a$\"m.elev\")) / sd(m_trns_a$\"m.elev\"))\nlibrary(psych)\npairs.panels(m_trns_hab[,], \n             method = \"pearson\", # correlation method\n             scale = FALSE, lm = FALSE,\n             hist.col = \"#00AFBB\", pch = 19,\n             density = TRUE,  # show density plots\n             ellipses = TRUE, # show correlation ellipses\n             alpha = 0.5\n             )\n\n#ANÁLISE DE REDUNDÂNCIA----\n\n##TRANFORMAÇÃO DA MATRIZ DE COMUNIDADE COM `hellinger`----\n\ncom_hell <- decostand(m_dens, method = \"hellinger\")\nm_trns_hab <- m_m\n\n### FAZENDO A RDA----\nrda <- rda(com_hell ~ ., m_trns_hab) #variavel de resposta ~ variavel explanatória\nsummary(rda)\n#str(rda)\nmodelo_rda <- rda$call\nmodelo_rda\n# Testando a significância dos resultados da RDA\nRsquareAdj(rda)\nanova.cca(rda) #significância global\nanova.cca(rda, by=\"axis\") #sign. dos eixos da RDA\nanova.cca(rda, by=\"terms\") #sign. das var. explanatórias\n\n### GRÁFICOS DE RDA----\n\n# Gráfico triplot basico\nplot(rda, choices = c(1,2))\nplot(rda, display = c(\"sp\",\"bp\"))\n\n# Ajustes no gráfico triplot\nmodel <- ordiplot(rda, type = \"none\", scaling = 2, xlab = \"RDA1\", ylab = \"RDA2\") #type=\"points\" ou \"text\"\n##UAs\npoints(rda, col = \"black\", pch = 21, bg = \"gray\", cex = 1)\ntext(rda, col = \"black\", cex = 0.7, pos = 1)\n##vetores\npoints(rda, dis = \"bp\", col = \"red\", pch = 21, cex = 1)\ntext(rda, dis = \"bp\", col = \"red\", cex = 0.9, pos = 2)\n##espécies\npoints(rda, dis = \"sp\", col = \"blue\", pch = 3, cex = 1)\ntext(rda, dis = \"sp\", col = \"blue\", cex = 0.8, pos = 1)\n# Show only the first [min:max] species with higher values\nhigh_species <- order(abs(scores(rda, display = \"species\")[, 1]), decreasing = TRUE)[1:9]\nhigh_species\n# Get the indices of the first 5 species with higher values on the first axis\npoints(rda, dis = \"sp\", select = high_species, col = \"darkblue\", pch = 3, cex = 1)\ntext(rda, display = \"species\", select = high_species, col = \"darkblue\", cex = 0.8, pos = 4)  #display the selected species\n\n### AVALIANDO COLINEARIDADE\n#(Step1-Remove the worst offender first, Step 2—Recheck VIF, Step 3—Final clean model)\n# Função variance inflation factors\nvif.cca(rda) #remover valores com colinearidade maior que 20\nrda\n#rda <- rda(formula = com_hell ~ river_length + depth_hab + depth_max + slope + width, data = m_trns_hab)\n\n### ESCOLHENDO AS PRINCIPAIS VARIÁVEIS DO MODELO DA RDA\n#It is important to note that selecting variables ecologically is much more important than performing selection in this way. If a variable of ecological interest is not selected, this does not mean it has to be removed from the RDA (\"https://r.qcbs.ca/workshop10/book-en/redundancy-analysis.html\").\n\n# GLM\nrda1 <- step(rda, scope = formula(rda), scale = 0, direction = \"both\", steps = 1000, test = \"perm\") #step refits a new RDA with variables added or removed, based on permutations and AIC\nsummary(rda1)\nmodelo_rda1 <- rda1$call #variáveis sugeridas pelo modelo\nmodelo_rda1\n\n#(matriz de dados comunitária ~ variáveis da matriz ambiental)\nrda2 <- rda(formula(rda1), data = m_trns_hab)\n#(variáveis de resposta ~ variaveis explanatórias sugeridas pelo modelo stepwise regression)\n#rda2 <- rda(formula = hell ~ turb, data = m_trns_hab)\nrda2\nsummary(rda2)\n#str(rda2)\n\n# Colinearidade do novo modelo\nvif.cca(rda2)\nsink(\"anovas_rda2_s.txt\")\n# ANOVAS\nRsquareAdj(rda2) #total variance explained and it´s significcance\nanova.cca(rda2, perm.max = 999)#overall model, do these variables together explain community composition better than random?\nanova.cca(rda2, by=\"axis\", perm.max = 999) #axes, are the canonical axes significant?\nanova.cca(rda2, by=\"terms\", perm.max = 999) #sequential (Type I) effects, does a given variable explain additional variance beyond the one entered before it in the model?\nanova.cca(rda2, by=\"margin\", perm.max = 999) #marginal (Type III) effects, does each variable explain variance after controlling for the other? *REPORT THIS\nsummary(rda2)\nsink()\n\n### INDIVIDUAL FINAL SIMPLIFIED TRIPLOT----\n# Getting axes explained variances\neig <- rda2$CCA$eig\nvar_exp <- eig / sum(rda2$tot.chi) * 100\nvar_exp\nRDA1_perc <- round(var_exp[1], 1)\nRDA2_perc <- round(var_exp[2], 1)\npng(\"fig-rda_h.png\", units = \"in\", width = 8, height = 8, res = 500)\nsimplified_model <- ordiplot(rda2, type = \"n\", scaling = 2, #ylim = c(-1, 1),\n                             xlab = paste0(\"RDA1 (\", RDA1_perc, \"%)\"),\n                             ylab = paste0(\"RDA2 (\", RDA2_perc, \"%)\"))\n##UAs\nUAs <- t_grps$UA\npoints(rda2, col = \"black\", pch = 21, bg = \"gray\", cex = 1)\ntext(rda2, labels = UAs, col = \"black\", cex = 0.8, pos = 2)\n##vetores\npoints(rda2, dis = \"bp\", col = \"red\", pch = 21, cex = 1)\ntext(rda2, dis = \"bp\", col = \"red\", cex = 0.9, pos = 1)\n##espécies\npoints(rda2, dis = \"sp\", col = \"red\", pch = 3, cex = 0.5)\n#text(rda2, dis = \"sp\", col = \"red\", pos = 1)\n##espécies principais\n# Show only the first [min:max] species with higher values\nhigh_species <- order(abs(scores(rda2, display = \"species\")[, 1]), decreasing = TRUE)[1:9]\nhigh_species\n# Get the indices of the first 5 species with higher values on the first axis\n#points(rda2, dis = \"sp\", select = high_species, col = \"darkblue\", pch = 3, cex = 1)\norditorp(rda2, dis = \"sp\", select = high_species, col = \"darkblue\", cex = 0.8, pos = 4, air = 0.5) #display the selected species\ndev.off()\n\n##COMBINED FINAL PANEL----\n\nlibrary(png)\nlibrary(grid)\nlibrary(gridExtra)\n\nimgs <- c(\"fig-rda_m.png\",\n          \"fig-rda_q.png\",\n          \"fig-rda_s.png\",\n          \"fig-rda_h.png\")\n\n# Read images and convert to grobs\nimg_grobs <- lapply(imgs, function(x) {\n  rasterGrob(readPNG(x), interpolate = TRUE)\n})\nlabels <- c(\"A\", \"B\", \"C\", \"D\")\nimg_grobs_labeled <- mapply(\n  function(img, lab) {\n    arrangeGrob(\n      img,\n      top = textGrob(lab, x = unit(0.15, \"npc\"), y = unit(-0.8, \"npc\"), #posição das labels\n                     just = c(\"left\", \"top\"),\n                     gp = gpar(fontsize = 14, fontface = \"bold\"))\n    )\n  },\n  img_grobs, labels,\n  SIMPLIFY = FALSE\n)\n\npng(\"fig-rda_panel.png\", units = \"in\", width = 10, height = 10, res = 500)\ngrid.arrange(\n  grobs = img_grobs_labeled,\n  ncol = 2,\n  top = textGrob(\"\", gp = gpar(fontsize = 16, fontface = \"bold\")))\ndev.off()\n\n### CROPPING IMAGENS----\nlibrary(png)\n# Read the image\nimg <- readPNG(\"fig-rda_h.png\")\nplot(as.raster(img))\n# Image dimensions\nh <- dim(img)[1]\nw <- dim(img)[2]\n# Crop size in pixels (1 inch at 500 dpi)\ncrop_px <- 500\n# Crop\nimg_cropped <- img[\n  (crop_px + 1):(h - crop_px),\n  (crop_px + 1):(w - crop_px),\n  ,\n  drop = FALSE\n]\nplot(as.raster(img_cropped))\n# Save cropped image\nwritePNG(img_cropped, \"cropped_rda_h.png\")\n\n# Cropping batch\n\nfiles <- c(\"fig-rda_m.png\", \"fig-rda_q.png\",\n           \"fig-rda_s.png\", \"fig-rda_h.png\")\nfor (f in files) {\n  img <- readPNG(f)\n  h <- dim(img)[1]\n  w <- dim(img)[2]\n  crop_px <- 500\n  img_cropped <- img[\n    (crop_px + 1):(h - crop_px),\n    (crop_px + 1):(w - crop_px),\n    ,\n    drop = FALSE\n  ]\n  writePNG(img_cropped, paste0(\"cropped_\", f))\n}"
  },
  {
    "objectID": "index.html#figures",
    "href": "index.html#figures",
    "title": "Predictors of the macroinvertebrate fauna in semiarid aquatic systems",
    "section": "Figures",
    "text": "Figures\n\n\nFig.: Environment data PCA - fviz\n\n\n\n\nFigure 1: Environment data Principal Component Analysis using the fviz function.\n\n\n\n\n\nFig.: Variation in rarefied richness\n\n\n\n\nFigure 2: Variation in rarefied richness across study sites.\n\n\n\n\n\nFig.: NMDS of community data\n\n\n\n\nFigure 3: Community data NMDS.\n\n\n\n\n\nFig.: Redundace Analisys\n\n\n\n\nFigure 4: Redundace Analisys."
  },
  {
    "objectID": "index.html#tables",
    "href": "index.html#tables",
    "title": "Predictors of the macroinvertebrate fauna in semiarid aquatic systems",
    "section": "Tables",
    "text": "Tables\n\n\nTab.: Environment data GT table\n\n\n\n\n\n\n\nTable 1:  Environment data GT table. \n  \n    \n      Variable\n      Code\n      MU\n      SA\n      EP\n      RE\n      CI\n      SE\n    \n  \n  \n    Morfology\n\n\n\n\n\n\n\n    River length (m)\ng.river.length\n214 (214-214)\n212.7 (212.7-212.7)\n196.8 (196.8-196.8)\n110.2 (110.2-110.2)\n83 (83-83)\n163.2 (163.2-163.2)\n    Altitude (m.a.s.l.)\ng.altitude\n725 (725-725)\n713 (713-713)\n402 (402-402)\n270 (270-270)\n169 (169-169)\n226 (226-226)\n    Marginal depth (cm)\nm.depth.hab\n29.7 (22-41.3)\n6.7 (4.7-8.2)\n50.7 (49.3-52.8)\n36.2 (22.3-54.7)\n33.3 (22.7-45.3)\n53.2 (32.3-81.3)\n    Maximum depth (m)\nm.depth.max\n114.7 (112-117)\n65 (60-69)\n95 (80-110)\n117 (87-154)\n67.8 (60-79)\n98.8 (74-110)\n    Slope\nm.slope\n30 (30-30)\n30 (30-30)\n90 (90-90)\n60 (60-60)\n60 (60-60)\n30 (30-30)\n    Site width (m)\nm.width\n240.4 (234.5-247.6)\n313.7 (289.5-330)\n25.6 (20-29.6)\n90.6 (72.2-102)\n15.4 (10.7-18.5)\n11.8 (5.4-19.6)\n    Water quality\n\n\n\n\n\n\n\n    Watel velocity (m/s)\nq.w.vel\n0 (0-0)\n0 (0-0)\n0 (0-0)\n0.025 (0-0.1)\n0.04 (0-0.159)\n0.073 (0-0.167)\n    Temperature (°C)\nq.temp\n27 (26-29)\n26.7 (24-29.2)\n29 (28.9-29)\n31.6 (29-34)\n30.4 (27.6-35.2)\n31.4 (28.3-32.9)\n    Dissolved oxygen (mg/L)\nq.do\n4.9 (1.8-7.3)\n6.1 (1.9-8.8)\n5.2 (5-5.6)\n7.1 (4.8-9.4)\n4.9 (3-6.9)\n6 (5.4-6.5)\n    Transparency (cm)\nq.turb\n65 (43-89)\n42.1 (25.7-55)\n37.4 (30-50)\n67.4 (51.7-90)\n42.3 (26-60)\n30.8 (16-46)\n    Habitat composition (%)\n\n\n\n\n\n\n\n    Macrophyte cover\nh.macroph\n0 (0-0)\n12.8 (0-46.7)\n0 (0-0)\n35.7 (5.8-54.8)\n0 (0-0)\n2.1 (0-8.3)\n    Littoral grass\nh.grass\n29.3 (5.6-54)\n5.2 (0-13.3)\n0.7 (0-2)\n2.1 (0-8.1)\n5.8 (0-23.3)\n11.1 (0.1-20)\n    Submerged vegetation\nh.subveg\n15 (0-36.6)\n7.3 (0-26)\n0 (0-0)\n4.2 (0-16.7)\n0.8 (0-3)\n2.5 (0-10)\n    Overhanging vegetation\nh.overhveg\n0 (0-0)\n0.9 (0-3.3)\n0 (0-0)\n10.4 (0-33.3)\n17.1 (0-33.3)\n0 (0-0)\n    Leaf litter\nh.litter\n2.1 (0.4-5)\n0 (0-0)\n0.4 (0.3-0.5)\n1.5 (0.6-3.7)\n1.5 (1-2.3)\n0.4 (0-0.8)\n    Algae\nh.algae\n10.1 (0-30)\n17.3 (0-43.3)\n0.1 (0-0.4)\n17.7 (0-33.3)\n21.4 (0-75)\n5.1 (0-12)\n    Root masses\nh.roots\n0 (0-0)\n0 (0-0)\n0 (0-0)\n0 (0-0)\n2.3 (0-5)\n0 (0-0)\n    Woody debris\nh.debris\n10.7 (10-11.7)\n0.9 (0-3.8)\n1.1 (0.4-2.5)\n7.2 (1.7-13.7)\n4.7 (1-10.3)\n2.6 (0-5)\n    Substrate composition (%)\n\n\n\n\n\n\n\n    Mud\ns.mud\n59.1 (20.6-91.8)\n94.4 (87.8-98)\n40.5 (33.7-48.9)\n48.1 (5-81.7)\n17.8 (0.7-48.8)\n66.4 (40-95)\n    Sand\ns.sand\n38.4 (3.2-77)\n3.9 (2-6.7)\n55.6 (47.9-63)\n45.5 (8.3-95)\n60 (22.5-87.7)\n23.7 (1.8-40)\n    Gravel\ns.gravel\n0.8 (0-2.4)\n1.7 (0-5.6)\n3.1 (2-4)\n4.3 (0-13.3)\n19.7 (11.7-28.8)\n6.3 (0.3-20)\n    Rocks\ns.rock\n1.7 (0-5)\n0 (0-0)\n0.8 (0-1.2)\n2.1 (0-8.3)\n2.5 (0-10)\n3.6 (0-8.3)\n  \n  \n  \n\n\n\n\n\n\n\n\nTab.: Density of taxa GT table\n\n\n\n\n\n\n\nTable 2:  Density (ind/m2) taxa GT table. \n  \n    \n      Taxa\n      MU\n      SA\n      EP\n      RE\n      CI\n      SE\n      F.O.\n    \n  \n  \n    INSECTA\n\n\n\n\n\n\n\n    Hemiptera\n\n\n\n\n\n\n\n    Belastomatidae\n0\n0\n0\n1(2.1)\n0\n0\n4.545455\n    Corixidae\n0\n0\n0\n10.9(21.9)\n447.4(693.4)\n0\n18.181818\n    Naucoridae\n0\n0\n0\n6.3(11.2)\n0\n0.5(1.0)\n13.636364\n    Notonectidae\n6.2(10.8)\n0\n0\n5.7(11.5)\n22.4(15.5)\n1.6(3.1)\n27.272727\n    Veliidae\n0\n0\n0\n0\n1.6(3.1)\n0\n4.545455\n    Coleoptera\n\n\n\n\n\n\n\n    Curculionidae\n0\n0\n0\n2.6(5.2)\n0.5(1.0)\n0\n9.090909\n    Dytiscidae (larvae)\n0\n0\n0\n1(1.2)\n2.1(2.9)\n0\n18.181818\n    Dytiscidae (adult)\n0.7(1.2)\n0\n0\n3.6(7.3)\n4.2(5.1)\n9.4(18.8)\n22.727273\n    Gerridae\n0\n0\n0\n0\n1(2.1)\n0\n4.545455\n    Hidrophilidae (larvae)\n0\n0\n0\n5.7(5.7)\n115.1(179.0)\n0.5(1.0)\n27.272727\n    Hidrophilide (adult)\n0\n0\n0\n38(47.2)\n5.2(6.5)\n7.8(15.6)\n31.818182\n    Diptera\n\n\n\n\n\n\n\n    Ceratopogonidae\n0\n0\n0.7(1.2)\n9.4(12.0)\n25.5(38.7)\n3.6(7.3)\n45.454545\n    Chaoboridae\n0\n0\n0\n0\n1(2.1)\n0\n4.545455\n    Chironomidae (larvae)\n4.2(3.6)\n15.1(6.4)\n7.6(6.7)\n509.9(926.2)\n2483.9(2583.7)\n442.2(862.2)\n90.909091\n    Chironomidae (pupae)\n0\n1(2.1)\n0\n12.5(25.0)\n57.3(82.5)\n1.6(3.1)\n22.727273\n    Ephemeroptera\n\n\n\n\n\n\n\n    Baetidae\n2.1(3.6)\n0.5(1.0)\n0\n9.4(16.1)\n46.9(86.9)\n0\n31.818182\n    Caenidae\n0\n0\n0\n14.1(28.1)\n65.1(130.2)\n0.5(1.0)\n13.636364\n    Leptohyphidae\n0\n0\n0\n0\n18.2(36.5)\n0\n4.545455\n    Odonata\n\n\n\n\n\n\n\n    Coenagrionidae\n0\n0\n0\n8.3(12.6.0)\n0\n1(2.1)\n18.181818\n    Gomphidae\n0\n0.5(1.0)\n0.7(1.2)\n1(2.1)\n13(14.5)\n5.7(7.5)\n40.909091\n    Libellulidae\n0\n0\n0\n77.1(39.5)\n47.4(80.2)\n0\n27.272727\n    Trichoptera\n\n\n\n\n\n\n\n    Glossosomatidae\n0\n0\n0\n0\n3.1(3.6)\n0\n9.090909\n    Leptoceridae\n0\n0\n0\n0\n1.6(3.1)\n0\n4.545455\n    GASTROPODA\n\n\n\n\n\n\n\n    Ampularidae\n0\n0.5(1.0)\n0\n0\n1.6(2.0)\n0\n13.636364\n    Lymnaeidae\n0\n0\n0\n1.6(3.1)\n0\n0\n4.545455\n    Planorbidae\n0\n3.1(4.0)\n0.7(1.2)\n98.4(145.3)\n139.1(218.3)\n132.3(238.6)\n59.090909\n    Physidae\n0\n0\n0\n15.6(18.0)\n0\n0\n13.636364\n    Thiaridae\n0\n16.1(28.3)\n2090.3(1051.4)\n0\n1(1.2)\n5785.9(5418.1)\n50.000000\n    CRUSTACEA\n\n\n\n\n\n\n\n    Atyidae\n0\n0\n9(10.7)\n0\n0\n24(28.5)\n18.181818\n    Conchostraca\n0\n0\n0\n93.8(146.0)\n0\n0\n13.636364\n    Ostracoda\n0\n0\n0\n67.7(131.3)\n0\n0\n9.090909\n    ANNELIDA\n\n\n\n\n\n\n\n    Hirudinea\n0\n0\n0\n4.2(5.1)\n0\n0\n9.090909\n    Oligochaeta\n0\n1.6(2.0)\n95.8(143.2)\n2016.1(869.3)\n3.1(2.7)\n0\n50.000000\n    BIVALVIA\n\n\n\n\n\n\n\n    Sphaeridae\n0\n0\n0\n0\n0.5(1.0)\n0\n4.545455\n    TROMBIDIFORMES\n\n\n\n\n\n\n\n    Hydrachnidia\n0\n0\n0\n0\n23.4(46.9)\n0\n4.545455"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Sobre este MS",
    "section": "",
    "text": "Tentativa de manuscrito para a NENT\nNENT\nPredictors of the macroinvertebrate fauna in semiarid aquatic systems\nAssemblage structure of freshwater macroinvertebrates in semiarid Brazil: importance of habitat structure\nEstrutura da assembleia de macroinvertebrados em ambientes aquáticos do semiárido brasileiro: importância da estrutura do habitat\nElvio S. F. Medeiros1,2, Rafaela L. de Farias1, Laryssa K. de Carvalho1\n1 Grupo Ecologia de Rios do Semiárido, Laboratório de Ecologia,\nCentro de Ciências Biológicas e Sociais Aplicadas,\nUniversidade Estadual da Paraíba – UEPB,\nRua Horácio Trajano, s/n, CEP 58070-450,\nJoão Pessoa, PB, Brasil\n2 Corresponding author: Elvio S. F. Medeiros, elviomedeiros@servidor.uepb.edu.br\nAuthor e-mails:\nRafaela L. de Farias: rafaela_lima88@hotmail.com\nLaryssa K. de Carvalho: laryssakalliane@hotmail.com"
  },
  {
    "objectID": "script.html",
    "href": "script.html",
    "title": "Script do MS",
    "section": "",
    "text": "Aqui apresento o scrip na íntegra sem os textos ou outros comentários. Você pode copiar e colar no R para executá-lo. Lembre-se de remover os # ou ## caso necessite executar essas linhas."
  }
]